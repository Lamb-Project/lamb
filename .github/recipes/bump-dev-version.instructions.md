```instructions
---
description: Bump the `dev` version and create an annotated tag
---

# Bump the dev version

## Purpose
Short, repeatable instructions to bump the `dev` version used by the frontend build and to create a corresponding annotated Git tag.

## Files involved
- `frontend/svelte-app/scripts/generate-version.js` — source of record for the dev version.
- `frontend/svelte-app/src/lib/version.js` — auto-generated by the script (normally git-ignored).

> Note: `src/lib/version.js` is usually ignored. The preferred workflow is to commit only the change to the generator script.

## Core workflow

1. Edit the generator script and update the version string

```bash
# open the file and change the version value
$EDITOR frontend/svelte-app/scripts/generate-version.js
# e.g. version: '0.3' -> version: '0.4'
```

2. Regenerate the version file locally

```bash
node frontend/svelte-app/scripts/generate-version.js
# This writes frontend/svelte-app/src/lib/version.js with commit/branch/date info
```

3. Verify the generated file contains the updated version

```bash
cat frontend/svelte-app/src/lib/version.js
# confirm the "version" field is correct
```

4. Commit the generator script change (recommended)

```bash
git add frontend/svelte-app/scripts/generate-version.js
git commit -m "chore: bump dev version to 0.4"
```

If you intentionally want to track the generated file (not typical):

```bash
# Force-add only if you really want to track this generated artifact
git add -f frontend/svelte-app/src/lib/version.js
git commit -m "chore: add generated version file for v0.4"
```

5. Create an annotated tag and push

```bash
git tag -a v0.4 -m "Release v0.4"
git push origin HEAD
git push origin v0.4
```

6. (Optional) Open a PR that references the tag or create release notes in GitHub

## Checklist
- [ ] Edit `generate-version.js` version string
- [ ] Run generator and verify `src/lib/version.js`
- [ ] Commit script change
- [ ] Create annotated tag `vX.Y`
- [ ] Push commit and tag
- [ ] (Optional) Draft release notes / PR

## Key rules
- Prefer committing the script only; do not commit generated files unless there's a clear reason.
- Use annotated tags ( `git tag -a vX.Y -m "Release vX.Y"` ).

## Troubleshooting
- If `git add` refuses to add `src/lib/version.js` because it's ignored, do not force-add unless you understand why it's ignored (committing the script is recommended).
- To recreate a tag if you made a mistake:

```bash
# delete local
git tag -d v0.4
# delete remote
git push origin :refs/tags/v0.4
# then recreate
git tag -a v0.4 -m "Release v0.4"
git push origin v0.4
```

- If CI or caches don't pick up the new version, clear caches or trigger a new build.

```instructions```