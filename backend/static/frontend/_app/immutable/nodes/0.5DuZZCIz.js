import{s as Me,a as ye}from"../chunks/GobYesUP.js";import{i as fe,j as Ce,t as B,s as I,a as $,d as le,c as we}from"../chunks/C82hPXC8.js";import{C as ke,F as Y,H as ne,Q as $e,M as oe,a5 as Re,aH as Te,aI as Ue,D as qe,G as ze,a3 as Le,ai as Se,ab as je,p as P,j as _,an as be,o as N,c as a,aq as Pe,r as s,s as f,i as p,t as H,e as Ne,a as O,aD as Ie,a6 as j,f as X,ak as Oe}from"../chunks/DZNCS3vC.js";import{p as ie}from"../chunks/B_zbZ6nJ.js";import{a as z,s as de}from"../chunks/CVH_3kCa.js";import{i as S}from"../chunks/fI70I6vP.js";import{s as V}from"../chunks/D5v_xaba.js";import{s as E}from"../chunks/D8EjMQFO.js";import{u as J}from"../chunks/CJASC4tQ.js";import{i as De}from"../chunks/C9TgNfkd.js";import{a as ce,$ as Be}from"../chunks/weotW1oH.js";import{p as Fe}from"../chunks/DbCUo_rN.js";import{p as he}from"../chunks/LPlWZjWK.js";import{g as xe}from"../chunks/Dzr2J0Wh.js";import{a as se}from"../chunks/C71FwA8D.js";function Ge(v,e,i,l,g){var t=v,r="",m;ke(()=>{if(r===(r=e()??"")){Y&&ne();return}m!==void 0&&(Le(m),m=void 0),r!==""&&(m=$e(()=>{if(Y){oe.data;for(var d=ne(),x=d;d!==null&&(d.nodeType!==8||d.data!=="");)x=d,d=Re(d);if(d===null)throw Te(),Ue;fe(oe,x),t=qe(d);return}var k=r+"",u=Ce(k);fe(ze(u),u.lastChild),t.before(u)}))})}function Qe(v,e,i,l,g){var m;Y&&ne();var t=(m=e.$$slots)==null?void 0:m[i],r=!1;t===!0&&(t=e.children,r=!0),t===void 0||t(v,r?()=>l:l)}function We(v,e,...i){var l=v,g=je,t;ke(()=>{g!==(g=e())&&(t&&(Le(t),t=null),t=$e(()=>g(l,...i)))},Se),Y&&(l=oe)}const Ke=async()=>{Me();{let e=new URLSearchParams(window.location.search).get("lang");e||(e=localStorage.getItem("lang"));const l=e&&["es","en","ca","eu"].includes(e)?e:"es";ye(l)}return{}},At=Object.freeze(Object.defineProperty({__proto__:null,load:Ke},Symbol.toStringTag,{value:"Module"}));var Ve=(v,e)=>_(e,!p(e)),Ye=(v,e)=>e("es"),Je=(v,e)=>e("en"),Xe=(v,e)=>e("ca"),Ze=(v,e)=>e("eu"),et=B('<div class="origin-top-right absolute right-0 mt-2 w-24 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10"><div class="py-1"><button>ES</button> <button>EN</button> <button>CA</button> <button>EU</button></div></div>'),tt=B('<div class="lang-selector relative"><button class="inline-flex items-center px-3 py-1 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"> <svg class="ml-1 h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button> <!></div>');function rt(v,e){P(e,!1);let i=be(!1),l=be();ce.subscribe(u=>{_(l,u)});function g(u){p(i)&&!u.target.closest(".lang-selector")&&_(i,!1)}function t(u){ye(u),_(i,!1)}N(()=>(document.addEventListener("click",g),()=>{document.removeEventListener("click",g)})),De();var r=tt(),m=a(r);m.__click=[Ve,i];var d=a(m);Pe(),s(m);var x=f(m,2);{var k=u=>{var o=et(),c=a(o),n=a(c);n.__click=[Ye,t];var b=f(n,2);b.__click=[Je,t];var y=f(b,2);y.__click=[Xe,t];var w=f(y,2);w.__click=[Ze,t],s(c),s(o),H(()=>{E(n,1,`block w-full text-left px-4 py-2 text-sm ${p(l)==="es"?"bg-gray-100 text-gray-900":"text-gray-700 hover:bg-gray-100"}`),E(b,1,`block w-full text-left px-4 py-2 text-sm ${p(l)==="en"?"bg-gray-100 text-gray-900":"text-gray-700 hover:bg-gray-100"}`),E(y,1,`block w-full text-left px-4 py-2 text-sm ${p(l)==="ca"?"bg-gray-100 text-gray-900":"text-gray-700 hover:bg-gray-100"}`),E(w,1,`block w-full text-left px-4 py-2 text-sm ${p(l)==="eu"?"bg-gray-100 text-gray-900":"text-gray-700 hover:bg-gray-100"}`)}),$(u,o)};S(x,u=>{p(i)&&u(k)})}s(r),H(u=>I(d,`${u??""} `),[()=>p(l).toUpperCase()],Ne),$(v,r),O()}le(["click"]);var at=B('<a href="/admin">Admin</a>'),st=B('<a target="_blank" class="inline-flex items-center px-3 py-1 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">OpenWebUI</a>'),nt=B('<div class="flex items-center space-x-4"><span class="text-sm font-medium text-gray-700"> </span> <!> <button class="inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700"> </button></div>'),ot=B('<nav class="bg-white shadow"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class="flex justify-between h-16"><div class="flex"><div class="flex-shrink-0 flex items-center"><div class="flex items-center space-x-2"><img src="/static/img/lamb_1.png" alt="LAMB Logo" class="h-14"> <div><div class="text-lg font-bold"><a href="/">LAMB</a> <span class="text-xs bg-gray-200 px-1 py-0.5 rounded">v0.1</span></div> <span class="text-xs text-gray-600">Learning Assistants Manager and Builder</span></div></div></div> <div class="hidden sm:ml-6 sm:flex sm:space-x-8"><a href="/"> </a> <a href="/assistants"> </a> <!> <a href="/knowledgebases"> </a></div></div> <div class="flex items-center"><!> <div class="ml-4"><!></div></div></div></div></nav> <div class="bg-gray-100 py-2"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class="flex items-center"><input type="text" id="helpInput" class="flex-grow px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-[#2271b3] focus:border-[#2271b3]"> <button id="helpButton" class="ml-3 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-[#2271b3] hover:bg-[#195a91]"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd"></path></svg> </button></div></div></div>',1);function it(v,e){P(e,!0);const[i,l]=de(),g=()=>z(Fe,"$page",i),t=()=>z(Be,"$_",i),r=()=>z(J,"$user",i),m=Ie();let d=j(!1);function x(){J.logout(),window.location.href="/"}function k(){const h=document.getElementById("helpInput");h instanceof HTMLInputElement&&h.value.trim()&&(m("help",{question:h.value.trim()}),h.value="")}N(()=>ce.subscribe(L=>{L&&_(d,!0)}));var u=ot(),o=X(u),c=a(o),n=a(c),b=a(n),y=f(a(b),2),w=a(y),M=a(w,!0);s(w);var A=f(w,2),T=a(A,!0);s(A);var D=f(A,2);{var F=h=>{var L=at();H(()=>E(L,1,`inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ${g().url.pathname==="/admin"?"border-[#2271b3] text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"}`)),$(h,L)};S(D,h=>{r().isLoggedIn&&r().data&&r().data.role==="admin"&&h(F)})}var C=f(D,2),G=a(C,!0);s(C),s(y),s(b);var R=f(b,2),Q=a(R);{var Z=h=>{var L=nt(),U=a(L),te=a(U,!0);s(U);var K=f(U,2);{var re=q=>{var pe=st();H(()=>V(pe,"href",r().owiUrl)),$(q,pe)};S(K,q=>{r().owiUrl&&q(re)})}var ae=f(K,2);ae.__click=x;var He=a(ae,!0);s(ae),s(L),H(q=>{I(te,r().name),I(He,q)},[()=>p(d)?t()("auth.logout"):"Logout"]),$(h,L)};S(Q,h=>{r().isLoggedIn&&h(Z)})}var W=f(Q,2),Ae=a(W);rt(Ae,{}),s(W),s(R),s(n),s(c),s(o);var ve=f(o,2),ue=a(ve),ge=a(ue),me=a(ge),ee=f(me,2);ee.__click=k;var Ee=f(a(ee));s(ee),s(ge),s(ue),s(ve),H((h,L,U,te,K,re)=>{E(w,1,`inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ${g().url.pathname==="/"?"border-[#2271b3] text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"}`),I(M,h),E(A,1,`inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ${g().url.pathname==="/assistants"?"border-[#2271b3] text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"} ${r().isLoggedIn?"":"opacity-50 pointer-events-none"}`),V(A,"aria-disabled",!r().isLoggedIn),I(T,L),E(C,1,U),V(C,"aria-disabled",!r().isLoggedIn),I(G,te),V(me,"placeholder",K),I(Ee,` ${re??""}`)},[()=>p(d)?t()("nav.home"):"Home",()=>p(d)?t()("assistants.title"):"Learning Assistants",()=>`inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ${g().url.pathname.startsWith("/knowledgebases")?"border-[#2271b3] text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"} ${r().isLoggedIn?"":"opacity-50 pointer-events-none"}`,()=>p(d)?t()("knowledgeBases.title"):"Knowledge Bases",()=>p(d)?t()("help.askQuestion"):"Ask LAMB anything...",()=>p(d)?t()("help.title"):"LAMB Help"]),$(v,u),O(),l()}le(["click"]);function _e(v,e){e("close")}var lt=B('<div class="fixed inset-0 z-50 overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true"><div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"><div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"></div> <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"><div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"><div class="sm:flex sm:items-start"><div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"><h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title"> </h3> <div class="mt-4 prose prose-sm max-w-none"><!></div></div></div></div> <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"><button type="button" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm"> </button></div></div></div></div>');function dt(v,e){P(e,!0);const[i,l]=de(),g=()=>z(Be,"$_",i);let t=j(!1);const r=Ie();let m=he(e,"show",3,!1),d=he(e,"response",3,"");N(()=>ce.subscribe(c=>{c&&_(t,!0)}));var x=we(),k=X(x);{var u=o=>{var c=lt(),n=a(c),b=a(n);b.__click=[_e,r];var y=f(b,2),w=a(y),M=a(w),A=a(M),T=a(A),D=a(T,!0);s(T);var F=f(T,2),C=a(F);Ge(C,d),s(F),s(A),s(M),s(w);var G=f(w,2),R=a(G);R.__click=[_e,r];var Q=a(R,!0);s(R),s(G),s(y),s(n),s(c),H((Z,W)=>{I(D,Z),I(Q,W)},[()=>p(t)?g()("help.title"):"LAMB Assistant Response",()=>p(t)?g()("common.confirm"):"Accept"]),$(o,c)};S(k,o=>{m()&&o(u)})}$(v,x),O(),l()}le(["click"]);function ct(v,e){P(e,!0);let i=j(!1);N(()=>{const t=J.subscribe(r=>{console.log("Auth state changed:",r.isLoggedIn?"logged in":"logged out");const m=p(i);_(i,ie(r.isLoggedIn)),!m&&p(i)&&(console.log("User logged in, loading fresh data"),se.loadAssistants()),m&&!p(i)&&(console.log("User logged out, clearing caches"),se.reset())});return()=>{t()}}),Oe(()=>{se.destroy()});var l=we(),g=X(l);Qe(g,e,"default",{}),$(v,l),O()}var vt=B('<!> <main class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8"><!></main> <!>',1),ut=B('<div class="min-h-screen bg-gray-50"><!></div>');function Et(v,e){P(e,!0);const[i,l]=de(),g=()=>z(J,"$user",i);let t=j(!1),r=j("");function m(){_(t,!1)}async function d(o){const c=o.detail.question;if(c)try{const n=await xe(c);_(r,ie(n.html||"No response available")),_(t,!0)}catch(n){console.error("Error getting help:",n),_(r,"Sorry, there was an error processing your request."),_(t,!0)}}async function x(){const o=document.getElementById("helpInput"),c=o==null?void 0:o.value.trim();if(c){if(!g().token){alert("Please log in to use the help function");return}try{const n=document.getElementById("helpButton");n&&(n.disabled=!0,n.innerHTML='<svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Loading...');const b=await xe(c,g().token);b.success?(_(r,ie(b.response)),_(t,!0)):alert(b.error||"Error getting help")}catch(n){console.error("Help error:",n),alert("An error occurred while getting help")}finally{const n=document.getElementById("helpButton");n&&(n.disabled=!1,n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd" /></svg> LAMB Help')}}}N(()=>{const o=document.getElementById("helpButton"),c=document.getElementById("helpInput");return o&&o.addEventListener("click",x),c&&c.addEventListener("keypress",n=>{n.key==="Enter"&&x()}),()=>{o&&o.removeEventListener("click",x),c&&c.removeEventListener("keypress",x)}});var k=ut(),u=a(k);ct(u,{children:(o,c)=>{var n=vt(),b=X(n);it(b,{$$events:{help:d}});var y=f(b,2),w=a(y);We(w,()=>e.children),s(y);var M=f(y,2);dt(M,{get show(){return p(t)},get response(){return p(r)},$$events:{close:m}}),$(o,n)},$$slots:{default:!0}}),s(k),$(v,k),O(),l()}export{Et as component,At as universal};
