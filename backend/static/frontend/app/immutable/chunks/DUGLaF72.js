import{g as u}from"./BVlmaXU-.js";function p(){const r=localStorage.getItem("userToken");if(!r)throw new Error("Not authenticated");return r}async function h(r,o={}){const t={headers:{Authorization:`Bearer ${p()}`,"Content-Type":"application/json"}};return fetch(r,{...t,...o})}async function w(r=10,o=0,n={}){const t=localStorage.getItem("userToken");if(!t)throw new Error("Not authenticated");const a=new URLSearchParams({limit:r.toString(),offset:o.toString()});Object.entries(n).forEach(([l,c])=>{c!=null&&c!==""&&a.append(l,c.toString())});const e=u(`/rubrics?${a}`);console.log("Fetching rubrics from:",e);const i=await fetch(e,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!i.ok){let l="Failed to fetch rubrics";try{const c=await i.json();l=(c==null?void 0:c.detail)||l}catch{}throw console.error("API error response status:",i.status,"Detail:",l),new Error(l)}const s=await i.json();return{rubrics:Array.isArray(s==null?void 0:s.rubrics)?s.rubrics:[],total:typeof(s==null?void 0:s.total)=="number"?s.total:0}}async function f(r=10,o=0,n={}){const t=localStorage.getItem("userToken");if(!t)throw new Error("Not authenticated");const a=new URLSearchParams({limit:r.toString(),offset:o.toString()});Object.entries(n).forEach(([l,c])=>{c!=null&&c!==""&&a.append(l,c.toString())});const e=u(`/rubrics/public?${a}`);console.log("Fetching public rubrics from:",e);const i=await fetch(e,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!i.ok){let l="Failed to fetch public rubrics";try{const c=await i.json();l=(c==null?void 0:c.detail)||l}catch{}throw console.error("API error response status:",i.status,"Detail:",l),new Error(l)}const s=await i.json();return{rubrics:Array.isArray(s==null?void 0:s.rubrics)?s.rubrics:[],total:typeof(s==null?void 0:s.total)=="number"?s.total:0}}async function g(r){const o=localStorage.getItem("userToken");if(!o)throw new Error("Not authenticated");const n=u(`/rubrics/${r}`);console.log("Fetching rubric from:",n);const t=await fetch(n,{headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});if(!t.ok){let a=`Failed to fetch rubric with ID ${r}`;try{const e=await t.json();a=(e==null?void 0:e.detail)||a}catch{}throw console.error("API error response status:",t.status,"Detail:",a),new Error(a)}return await t.json()}async function b(r){var e,i;const o=localStorage.getItem("userToken");if(!o)throw new Error("Not authenticated");const n=new FormData;n.append("title",r.title||""),n.append("description",r.description||""),n.append("subject",((e=r.metadata)==null?void 0:e.subject)||""),n.append("gradeLevel",((i=r.metadata)==null?void 0:i.gradeLevel)||""),n.append("scoringType",r.scoringType||"points"),n.append("maxScore",(r.maxScore||100).toString()),n.append("criteria",JSON.stringify(r.criteria||[]));const t=u("/rubrics");console.log("Creating rubric at:",t);const a=await fetch(t,{method:"POST",headers:{Authorization:`Bearer ${o}`},body:n});if(!a.ok){let s="Failed to create rubric";try{const l=await a.json();s=(l==null?void 0:l.detail)||s}catch{}throw console.error("API error response status:",a.status,"Detail:",s),new Error(s)}return await a.json()}async function y(r,o){var i,s;const n=localStorage.getItem("userToken");if(!n)throw new Error("Not authenticated");const t=new FormData;t.append("title",o.title||""),t.append("description",o.description||""),t.append("subject",((i=o.metadata)==null?void 0:i.subject)||""),t.append("gradeLevel",((s=o.metadata)==null?void 0:s.gradeLevel)||""),t.append("scoringType",o.scoringType||"points"),t.append("maxScore",(o.maxScore||100).toString()),t.append("criteria",JSON.stringify(o.criteria||[]));const a=u(`/rubrics/${r}`);console.log("Updating rubric at:",a);const e=await fetch(a,{method:"PUT",headers:{Authorization:`Bearer ${n}`},body:t});if(!e.ok){let l=`Failed to update rubric with ID ${r}`;try{const c=await e.json();l=(c==null?void 0:c.detail)||l}catch{}throw console.error("API error response status:",e.status,"Detail:",l),new Error(l)}return await e.json()}async function m(r){const o=localStorage.getItem("userToken");if(!o)throw new Error("Not authenticated");const n=u(`/rubrics/${r}/duplicate`);console.log("Duplicating rubric at:",n);const t=await fetch(n,{method:"POST",headers:{Authorization:`Bearer ${o}`}});if(!t.ok){let a=`Failed to duplicate rubric with ID ${r}`;try{const e=await t.json();a=(e==null?void 0:e.detail)||a}catch{}throw console.error("API error response status:",t.status,"Detail:",a),new Error(a)}return await t.json()}async function k(r,o){const n=localStorage.getItem("userToken");if(!n)throw new Error("Not authenticated");const t=u(`/rubrics/${r}/visibility`);console.log("Toggling rubric visibility at:",t);const a=new FormData;a.append("is_public",o.toString());const e=await fetch(t,{method:"PUT",headers:{Authorization:`Bearer ${n}`},body:a});if(!e.ok){let i=`Failed to toggle visibility for rubric ${r}`;try{const s=await e.json();i=(s==null?void 0:s.detail)||i}catch{}throw console.error("API error response status:",e.status,"Detail:",i),new Error(i)}return await e.json()}async function A(r){const o=localStorage.getItem("userToken");if(!o)throw new Error("Not authenticated");const n=u(`/rubrics/${r}/export/markdown`);console.log("Fetching rubric Markdown from:",n);const t=await fetch(n,{headers:{Authorization:`Bearer ${o}`}});if(!t.ok){let e="Failed to fetch rubric as Markdown";try{const i=await t.json();e=(i==null?void 0:i.detail)||e}catch{}throw console.error("API error response status:",t.status,"Detail:",e),new Error(e)}return await t.text()}async function S(r,o="en",n=null){const t=localStorage.getItem("userToken");if(!t)throw new Error("Not authenticated");const a=u("/rubrics/ai-generate");console.log("Generating rubric with AI at:",a,"language:",o);const e={prompt:r,language:o};n&&(e.model=n);const i=await fetch(a,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify(e)});if(!i.ok){let l="Failed to generate rubric with AI";try{const c=await i.json();l=(c==null?void 0:c.detail)||(c==null?void 0:c.error)||l}catch{}throw console.error("API error response status:",i.status,"Detail:",l),new Error(l)}const s=await i.json();return!s.success&&s.error&&console.warn("AI generation failed:",s.error),s}async function j(r,o){const n=localStorage.getItem("userToken");if(!n)throw new Error("Not authenticated");const t=u(`/rubrics/${r}/ai-modify`);console.log("Modifying rubric with AI at:",t);const a=await fetch(t,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({prompt:o})});if(!a.ok){let e=`Failed to modify rubric ${r} with AI`;try{const i=await a.json();e=(i==null?void 0:i.detail)||e}catch{}throw console.error("API error response status:",a.status,"Detail:",e),new Error(e)}return await a.json()}async function T(){const r=await h(`${u("/rubrics/accessible")}`);if(!r.ok){let o="Failed to fetch accessible rubrics";try{o=(await r.json()).detail||o}catch{}throw console.error("API error response status:",r.status,"Detail:",o),new Error(o)}return await r.json()}export{f as a,S as b,b as c,m as d,g as e,w as f,j as g,T as h,A as i,k as t,y as u};
