import{d as la,g as Fa,b as i,t as v,r as ya,s as r,e as wa,f as wt}from"../chunks/DbBWcICI.js";import{p as oa,av as Ca,w as sa,m as a,j as k,n as ia,q as l,o as t,l as s,r as e,t as n,k as ha,A as Ba,u as Sa,v as Pa}from"../chunks/DMsokd5p.js";import{i as f}from"../chunks/MBI0PpQy.js";import{r as Ht,s as Vt,a as le,e as $a,d as La,b as _a}from"../chunks/gPkShxx4.js";import{s as da,a as Wt}from"../chunks/BsHaMxS4.js";import{e as Jt,i as ba}from"../chunks/D6e1hy_S.js";import{b as Ta,p as Ua}from"../chunks/DEkYYQ3O.js";import{c as Aa,g as Na,a as za,b as Ma,u as Oa}from"../chunks/CtNWh4s7.js";import{$ as na}from"../chunks/B9q8dB_t.js";import{u as Ra}from"../chunks/CmzVOFLo.js";import{g as Ea,b as Ka}from"../chunks/DlJa0Cru.js";import{b as ka,c as qa}from"../chunks/CFRbuANL.js";import{s as xa}from"../chunks/CG3iaoFh.js";import{i as ja,s as Qa}from"../chunks/BVQ_Nsm3.js";import{a as Ja}from"../chunks/t--hEgTQ.js";import{g as Va}from"../chunks/BWNE5xtz.js";import{p as Ha}from"../chunks/3ElTuAwM.js";function Wa(b,u){b.key==="Escape"&&u()}function Ga(b,u){u()}function Ya(b){b.stopPropagation()}var Xa=v('<div class="mb-4 p-2 bg-red-50 text-red-500 text-sm rounded"> </div>'),Za=v('<p class="mt-1 text-sm text-red-600"> </p>'),er=v('<div class="fixed inset-0 z-40 overflow-y-auto"><div class="fixed inset-0 bg-black bg-opacity-50 transition-opacity" aria-hidden="true"></div> <div class="flex min-h-screen items-center justify-center p-4"><div class="relative bg-white rounded-lg shadow-xl max-w-lg w-full mx-auto p-6" tabindex="-1" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="mb-4"><h3 id="modal-title" class="text-lg font-medium text-gray-900"> </h3> <p class="text-sm text-gray-500 mt-1"> </p></div> <!> <form class="space-y-4"><div><label for="kb-name" class="block text-sm font-medium text-gray-700"> </label> <input type="text" id="kb-name"> <!></div> <div><label for="kb-description" class="block text-sm font-medium text-gray-700"> </label> <textarea id="kb-description" rows="3" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-[#2271b3] focus:border-[#2271b3] sm:text-sm"></textarea></div> <div><fieldset><legend class="block text-sm font-medium text-gray-700"> </legend> <div class="mt-2 space-y-2"><div class="flex items-center"><input id="private" name="accessControl" type="radio" class="h-4 w-4 text-[#2271b3] focus:ring-[#2271b3] border-gray-300"> <label for="private" class="ml-2 block text-sm text-gray-700"> </label></div> <div class="flex items-center"><input id="public" name="accessControl" type="radio" class="h-4 w-4 text-[#2271b3] focus:ring-[#2271b3] border-gray-300"> <label for="public" class="ml-2 block text-sm text-gray-700"> </label></div></div> <p class="mt-1 text-xs text-gray-500"> </p></fieldset></div> <div class="mt-5 sm:mt-6 sm:grid sm:grid-cols-2 sm:gap-3 sm:grid-flow-row-dense"><button type="submit" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-[#2271b3] text-base font-medium text-white hover:bg-[#195a91] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#2271b3] sm:col-start-2 sm:text-sm" style="background-color: #2271b3;"><!></button> <button type="button" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:col-start-1 sm:text-sm"> </button></div></form></div></div></div>');function tr(b,u){oa(u,!0);const[x,st]=da(),o=()=>Wt(na,"$_",x),c=[],_=Ca();let X=k(!1),j=k(!1),Z=k(""),E=k(""),Q=k(""),_e=k("private"),ne=k("");function M(){l(X,!0),q()}function ze(){a(j)||(l(X,!1),q(),_("close"))}function q(){l(E,""),l(Q,""),l(_e,"private"),l(Z,""),l(ne,""),l(j,!1)}function ee(){let D=!0;return l(ne,""),l(Z,""),a(E).trim()?a(E).length>50&&(l(ne,o()("knowledgeBases.createModal.nameTooLong",{default:"Name must be less than 50 characters"}),!0),D=!1):(l(ne,o()("knowledgeBases.createModal.nameRequired",{default:"Name is required"}),!0),D=!1),D}async function Fe(D){if(D.preventDefault(),!!ee()){l(j,!0),l(Z,"");try{const L=await Aa({name:a(E).trim(),description:a(Q).trim()||void 0,access_control:a(_e)});console.log("Knowledge base created:",L),l(X,!1),_("created",{id:L.kb_id,name:L.name,message:L.message}),q()}catch(L){console.error("Error creating knowledge base:",L),l(Z,L instanceof Error?L.message:"Failed to create knowledge base",!0),l(j,!1)}}}var h=Fa(),O=sa(h);{var R=D=>{var L=er(),ue=t(L);ue.__click=[Ga,ze];var Pe=s(ue,2),Le=t(Pe);Le.__click=[Ya],Le.__keydown=[Wa,ze];var Me=t(Le),Ve=t(Me),Gt=t(Ve,!0);e(Ve);var y=s(Ve,2),oe=t(y,!0);e(y),e(Me);var te=s(Me,2);{var Oe=C=>{var J=Xa(),me=t(J,!0);e(J),n(()=>r(me,a(Z))),i(C,J)};f(te,C=>{a(Z)&&C(Oe)})}var he=s(te,2),Ee=t(he),Re=t(Ee),ht=t(Re);e(Re);var pe=s(Re,2);Ht(pe);var d=s(pe,2);{var g=C=>{var J=Za(),me=t(J,!0);e(J),n(()=>r(me,a(ne))),i(C,J)};f(d,C=>{a(ne)&&C(g)})}e(Ee);var p=s(Ee,2),w=t(p),F=t(w,!0);e(w);var A=s(w,2);ya(A),e(p);var T=s(p,2),be=t(T),H=t(be),ie=t(H,!0);e(H);var W=s(H,2),xe=t(W),ae=t(xe);Ht(ae),ae.value=ae.__value="private";var ke=s(ae,2),He=t(ke,!0);e(ke),e(xe);var Be=s(xe,2),N=t(Be);Ht(N),N.value=N.__value="public";var $e=s(N,2),Ke=t($e,!0);e($e),e(Be),e(W);var Te=s(W,2),vt=t(Te,!0);e(Te),e(be),e(T);var Ut=s(T,2),We=t(Ut),Yt=t(We);{var ut=C=>{var J=wt();n(me=>r(J,me),[()=>o()("knowledgeBases.creating",{default:"Creating..."})]),i(C,J)},At=C=>{var J=wt();n(me=>r(J,me),[()=>o()("knowledgeBases.create",{default:"Create Knowledge Base"})]),i(C,J)};f(Yt,C=>{a(j)?C(ut):C(At,!1)})}e(We);var ct=s(We,2);ct.__click=ze;var kt=t(ct,!0);e(ct),e(Ut),e(he),e(Le),e(Pe),e(L),n((C,J,me,De,Xt,Ue,ft,Ge,gt,Nt,Bt)=>{r(Gt,C),r(oe,J),r(ht,`${me??""} *`),Vt(pe,1,`mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-[#2271b3] focus:border-[#2271b3] sm:text-sm ${a(ne)?"border-red-300 focus:ring-red-500 focus:border-red-500":""}`),le(pe,"placeholder",De),r(F,Xt),le(A,"placeholder",Ue),r(ie,ft),r(He,Ge),r(Ke,gt),r(vt,Nt),We.disabled=a(j),ct.disabled=a(j),r(kt,Bt)},[()=>o()("knowledgeBases.createPageTitle",{default:"Create Knowledge Base"}),()=>o()("knowledgeBases.createModal.description",{default:"Create a new knowledge base to store and retrieve documents."}),()=>o()("knowledgeBases.name",{default:"Name"}),()=>o()("knowledgeBases.namePlaceholder",{default:"Enter knowledge base name"}),()=>o()("knowledgeBases.description",{default:"Description"}),()=>o()("knowledgeBases.descriptionPlaceholder",{default:"Enter a description for this knowledge base"}),()=>o()("knowledgeBases.accessControl",{default:"Access Control"}),()=>o()("knowledgeBases.private",{default:"Private"}),()=>o()("knowledgeBases.public",{default:"Public"}),()=>o()("knowledgeBases.accessControlHelp",{default:"Private knowledge bases are only accessible by you, while public ones can be accessed by other users."}),()=>o()("knowledgeBases.cancel",{default:"Cancel"})]),wa("submit",he,Fe),ka(pe,()=>a(E),C=>l(E,C)),ka(A,()=>a(Q),C=>l(Q,C)),qa(c,[],ae,()=>a(_e),C=>l(_e,C)),qa(c,[],N,()=>a(_e),C=>l(_e,C)),i(D,L)};f(O,D=>{a(X)&&D(R)})}i(b,h);var ve=ia({open:M});return st(),ve}la(["click","keydown"]);var ar=v('<div class="p-4 bg-green-50 border-b border-green-100"><div class="text-sm text-green-700"> </div></div>'),rr=v('<div class="p-6 text-center"><div class="animate-pulse text-gray-500"> </div></div>'),sr=v('<div><p class="font-bold mb-2"> </p> <p> </p></div>'),lr=(b,u)=>u(),or=v('<div class="p-6 text-center"><div class="text-red-500"><!></div> <button class="mt-4 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-[#2271b3] hover:bg-[#195a91] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#2271b3]" style="background-color: #2271b3;"> </button></div>'),ir=v('<div class="p-6 text-center"><div class="text-gray-500"> </div></div>'),dr=(b,u,x)=>u(a(x).id),nr=(b,u,x)=>u(a(x).id),vr=(b,u,x)=>u(a(x).id),ur=v('<tr><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm font-medium text-gray-900"><button type="button" class="text-[#2271b3] hover:text-[#195a91] hover:underline text-left font-medium p-0 bg-transparent border-0 cursor-pointer" style="color: #2271b3;"> </button></div> <div class="text-sm text-gray-500"> </div></td><td class="px-6 py-4 whitespace-normal"><div class="text-sm text-gray-900"> </div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900"> </div></td><td class="px-6 py-4 whitespace-nowrap"><span> </span></td><td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"><button class="text-[#2271b3] hover:text-[#195a91] mr-2" style="color: #2271b3;"> </button> <button type="button" class="text-[#2271b3] hover:text-[#195a91] mr-2" style="color: #2271b3;"> </button> <button class="text-red-600 hover:text-red-900"> </button></td></tr>'),cr=v('<div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> </th><th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"> </th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div>'),fr=v('<div class="bg-white shadow overflow-hidden sm:rounded-md"><div class="p-4 border-b border-gray-200 sm:flex sm:items-center sm:justify-between"><h3 class="text-lg leading-6 font-medium text-gray-900"> </h3> <div class="mt-3 sm:mt-0 sm:ml-4"><button class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-[#2271b3] hover:bg-[#195a91] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#2271b3]" style="background-color: #2271b3;"> </button></div></div> <!> <!> <!></div>');function gr(b,u){oa(u,!0);const[x,st]=da(),o=()=>Wt(Ra,"$user",x),c=()=>Wt(na,"$_",x);let _=k(ha([])),X=k(!0),j=k(""),Z=k(!1),E=k(""),Q;const _e=Ca();Ba(async()=>{await ne()});async function ne(){l(X,!0),l(j,""),l(Z,!1);try{if(!o().isLoggedIn){l(j,"You must be logged in to view knowledge bases."),l(X,!1);return}const y=await Na();l(_,y||[],!0),console.log("Knowledge bases loaded:",a(_).length)}catch(y){console.error("Error loading knowledge bases:",y),l(j,y instanceof Error?y.message:"Failed to load knowledge bases",!0),y instanceof Error&&y.message.includes("server offline")&&l(Z,!0)}finally{l(X,!1)}}function M(y){return y?new Date(y*1e3).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}function ze(){Q.open()}function q(y){_e("view",{id:y})}function ee(y){const{id:oe,name:te,message:Oe}=y.detail;l(E,Oe||c()("knowledgeBases.createSuccess",{values:{name:te},default:`Knowledge base "${te}" created successfully!`}),!0),setTimeout(()=>{l(E,"")},5e3),ne()}var Fe=fr(),h=t(Fe),O=t(h),R=t(O,!0);e(O);var ve=s(O,2),D=t(ve);D.__click=ze;var L=t(D,!0);e(D),e(ve),e(h);var ue=s(h,2);{var Pe=y=>{var oe=ar(),te=t(oe),Oe=t(te,!0);e(te),e(oe),n(()=>r(Oe,a(E))),i(y,oe)};f(ue,y=>{a(E)&&y(Pe)})}var Le=s(ue,2);{var Me=y=>{var oe=rr(),te=t(oe),Oe=t(te,!0);e(te),e(oe),n(he=>r(Oe,he),[()=>c()("knowledgeBases.list.loading",{default:"Loading knowledge bases..."})]),i(y,oe)},Ve=(y,oe)=>{{var te=he=>{var Ee=or(),Re=t(Ee),ht=t(Re);{var pe=w=>{var F=sr(),A=t(F),T=t(A,!0);e(A);var be=s(A,2),H=t(be,!0);e(be),e(F),n((ie,W)=>{r(T,ie),r(H,W)},[()=>c()("knowledgeBases.list.serverOffline",{default:"Knowledge Base Server Offline"}),()=>c()("knowledgeBases.list.tryAgainLater",{default:"Please try again later or contact an administrator."})]),i(w,F)},d=w=>{var F=wt();n(()=>r(F,a(j))),i(w,F)};f(ht,w=>{a(Z)?w(pe):w(d,!1)})}e(Re);var g=s(Re,2);g.__click=[lr,ne];var p=t(g,!0);e(g),e(Ee),n(w=>r(p,w),[()=>c()("knowledgeBases.list.retry",{default:"Retry"})]),i(he,Ee)},Oe=(he,Ee)=>{{var Re=pe=>{var d=ir(),g=t(d),p=t(g,!0);e(g),e(d),n(w=>r(p,w),[()=>c()("knowledgeBases.list.empty",{default:"No knowledge bases found."})]),i(pe,d)},ht=pe=>{var d=cr(),g=t(d),p=t(g),w=t(p),F=t(w),A=t(F,!0);e(F);var T=s(F),be=t(T,!0);e(T);var H=s(T),ie=t(H,!0);e(H);var W=s(H),xe=t(W,!0);e(W);var ae=s(W),ke=t(ae,!0);e(ae),e(w),e(p);var He=s(p);Jt(He,21,()=>a(_),Be=>Be.id,(Be,N)=>{var $e=ur(),Ke=t($e),Te=t(Ke),vt=t(Te);vt.__click=[dr,q,N];var Ut=t(vt,!0);e(vt),e(Te);var We=s(Te,2),Yt=t(We,!0);e(We),e(Ke);var ut=s(Ke),At=t(ut),ct=t(At,!0);e(At),e(ut);var kt=s(ut),C=t(kt),J=t(C,!0);e(C),e(kt);var me=s(kt),De=t(me),Xt=t(De,!0);e(De),e(me);var Ue=s(me),ft=t(Ue);ft.__click=[nr,q,N];var Ge=t(ft,!0);e(ft);var gt=s(ft,2);gt.__click=[vr,q,N];var Nt=t(gt,!0);e(gt);var Bt=s(gt,2),va=t(Bt,!0);e(Bt),e(Ue),e($e),n((ta,ua,ca,fa)=>{var I,$;r(Ut,a(N).name),r(Yt,a(N).id),r(ct,a(N).description||"-"),r(J,ta),Vt(De,1,`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${((I=a(N).metadata)==null?void 0:I.access_control)==="private"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`),r(Xt,(($=a(N).metadata)==null?void 0:$.access_control)||"public"),r(Ge,ua),r(Nt,ca),r(va,fa)},[()=>M(a(N).created_at),()=>c()("knowledgeBases.list.viewButton",{default:"View"}),()=>c()("knowledgeBases.list.editButton",{default:"Edit"}),()=>c()("knowledgeBases.list.deleteButton",{default:"Delete"})]),i(Be,$e)}),e(He),e(g),e(d),n((Be,N,$e,Ke,Te)=>{r(A,Be),r(be,N),r(ie,$e),r(xe,Ke),r(ke,Te)},[()=>c()("knowledgeBases.list.nameColumn",{default:"Name"}),()=>c()("knowledgeBases.list.descriptionColumn",{default:"Description"}),()=>c()("knowledgeBases.list.createdColumn",{default:"Created"}),()=>c()("knowledgeBases.list.accessColumn",{default:"Access"}),()=>c()("knowledgeBases.list.actionsColumn",{default:"Actions"})]),i(pe,d)};f(he,pe=>{a(_).length===0?pe(Re):pe(ht,!1)},Ee)}};f(y,he=>{a(j)?he(te):he(Oe,!1)},oe)}};f(Le,y=>{a(X)?y(Me):y(Ve,!1)})}var Gt=s(Le,2);Ta(tr(Gt,{$$events:{created:ee}}),y=>Q=y,()=>Q),e(Fe),n((y,oe)=>{r(R,y),r(L,oe)},[()=>c()("knowledgeBases.list.title",{default:"Knowledge Bases"}),()=>c()("knowledgeBases.list.createButton",{default:"Create Knowledge Base"})]),i(b,Fe),ia(),st()}la(["click"]);function pr(b,u,x,st){const o=b.target;o.files&&o.files.length>0?(l(u,o.files[0],!0),l(x,!1),l(st,""),console.log("Selected file:",a(u).name,a(u).type,a(u).size)):l(u,null)}var mr=v('<div class="p-6 text-center"><div class="animate-pulse text-gray-500"> </div></div>'),_r=v('<div><p class="font-bold mb-2"> </p> <p> </p></div>'),br=(b,u,x)=>u(x()),xr=v('<div class="p-6 text-center"><div class="text-red-500"><!></div> <button class="mt-4 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-[#2271b3] hover:bg-[#195a91] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#2271b3]" style="background-color: #2271b3;"> </button></div>'),yr=v('<div class="bg-white px-4 py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"><dt class="text-sm font-medium text-gray-500"> </dt> <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"> </dd></div>'),wr=v('<div class="bg-gray-50 px-4 py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"><dt class="text-sm font-medium text-gray-500"> </dt> <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"> </dd></div>'),hr=v('<div class="bg-white px-4 py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"><dt class="text-sm font-medium text-gray-500"> </dt> <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"><span> </span></dd></div>'),kr=(b,u)=>u("files"),Br=(b,u)=>u("ingest"),$r=(b,u)=>u("query"),qr=v('<a target="_blank" rel="noopener noreferrer" class="text-[#2271b3] hover:text-[#195a91] hover:underline" style="color: #2271b3;"> </a>'),Cr=v("<span> </span>"),Sr=(b,u,x)=>u(a(x).id),Er=v('<tr><td class="px-6 py-4 whitespace-nowrap"><div class="flex items-center"><div class="text-sm font-medium text-gray-900"><!></div></div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900"> </div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900"> </div></td><td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"><button class="text-red-600 hover:text-red-900"> </button></td></tr>'),Kr=v('<div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> </th><th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"> </th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div>'),Dr=v('<div class="text-center text-gray-500 py-4"> </div>'),Ir=v("<div><!></div>"),Fr=v('<div class="p-4 bg-green-50 border border-green-100 rounded"><div class="text-sm text-green-700"> </div></div>'),Pr=v('<div class="p-4 bg-red-50 border border-red-100 rounded"><div class="text-sm text-red-700"> </div></div>'),Lr=v('<p class="mt-2 text-sm text-gray-500"> </p>'),Tr=(b,u)=>{const x=b.target;x&&x.value&&u(parseInt(x.value))},Ur=v("<option> </option>"),Ar=v('<span class="text-xs text-gray-500 ml-1"> </span>'),Nr=(b,u,x)=>u(x(),b),zr=v("<option> </option>"),Mr=v('<select class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#2271b3] focus:border-[#2271b3] sm:text-sm"></select>'),Or=(b,u,x)=>u(x(),b),Rr=v('<div class="flex items-center"><input type="checkbox" class="h-4 w-4 text-[#2271b3] focus:ring-[#2271b3] border-gray-300 rounded"> <label class="ml-2 block text-sm text-gray-900"> </label></div>'),jr=(b,u,x)=>u(x(),b),Qr=v('<input type="number" class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#2271b3] focus:border-[#2271b3] sm:text-sm">'),Jr=(b,u,x)=>u(x(),b),Vr=v('<textarea rows="3" class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#2271b3] focus:border-[#2271b3] sm:text-sm"></textarea> <p class="mt-1 text-xs text-gray-500">Enter values separated by new lines.</p>',1),Hr=(b,u,x)=>u(x(),b),Wr=v('<input type="text" class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#2271b3] focus:border-[#2271b3] sm:text-sm">'),Gr=v('<div><label class="block text-sm font-medium text-gray-700"> <!></label> <div class="mt-1"><!></div></div>'),Yr=v('<div class="space-y-4 border-t border-gray-200 pt-4"><h5 class="font-medium text-gray-700"> </h5> <!></div>'),Xr=v('<form class="space-y-6"><!> <!> <div><label for="file-upload-input-inline" class="block text-sm font-medium text-gray-700"> </label> <div class="mt-1 flex items-center"><input id="file-upload-input-inline" type="file" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-[#2271b3] file:text-white hover:file:bg-[#195a91]" style="file:background-color: #2271b3;"></div> <!></div> <div><label for="plugin-select-inline" class="block text-sm font-medium text-gray-700"> </label> <div class="mt-1"><select id="plugin-select-inline" class="block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-[#2271b3] focus:border-[#2271b3] sm:text-sm rounded-md"></select></div></div> <!> <div class="pt-4 flex justify-end"><button type="submit" class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-[#2271b3] hover:bg-[#195a91] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#2271b3]" style="background-color: #2271b3;"><!></button></div></form>'),Zr=v('<div class="bg-gray-50 -mx-4 -my-5 sm:-mx-6 px-4 py-5 sm:px-6"><h4 class="text-md font-medium text-gray-700 mb-4"> </h4> <!></div>'),es=v('<div class="mt-4 p-4 border rounded-md bg-gray-50 text-center text-gray-500"> </div>'),ts=v('<div class="mt-4 p-4 border rounded-md bg-red-50 text-red-700"><p class="font-bold"> </p> <pre class="whitespace-pre-wrap text-sm"> </pre></div>'),as=v('<div class="mb-2 text-sm"><a target="_blank" rel="noopener noreferrer" class="text-[#2271b3] hover:text-[#195a91] hover:underline font-medium" style="color: #2271b3;"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline-block mr-1 -mt-0.5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0l-1.5-1.5a2 2 0 112.828-2.828l1.5 1.5a.5.5 0 00.707 0l1.5-1.5a.5.5 0 00-.707-.707l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0l1.5 1.5a.5.5 0 00.707 0l1.5-1.5a.5.5 0 00-.707-.707l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0l-1.5-1.5a2 2 0 112.828-2.828l1.5 1.5a.5.5 0 00.707 0l1.5-1.5a.5.5 0 00-.707-.707l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5a2 2 0 11-2.828-2.828z" clip-rule="evenodd"></path></svg> </a></div>'),rs=v('<div class="p-4 bg-white rounded-md shadow-sm border border-gray-200"><!> <div class="flex justify-between items-start mb-2"><h5 class="text-sm font-semibold text-[#2271b3]" style="color: #2271b3;"> </h5> <span class="text-xs px-2 py-0.5 rounded-full bg-blue-100 text-blue-800"> </span></div> <div class="text-sm text-gray-700 mb-3"><p class="font-medium mb-1"> </p> <div class="prose prose-sm max-w-none p-2 border rounded bg-gray-50 whitespace-pre-wrap break-words"> </div></div> <div class="text-xs text-gray-500 border-t pt-2"><p class="font-medium mb-1"> </p> <pre class="whitespace-pre-wrap text-xs bg-gray-50 p-2 rounded shadow-inner overflow-x-auto"> </pre></div></div>'),ss=v('<div class="space-y-6"></div>'),ls=v('<p class="text-sm text-gray-600"> </p>'),os=v('<div class="mt-4 p-4 border rounded-md bg-blue-50 space-y-4"><h4 class="text-md font-medium text-gray-900"> </h4> <!> <details class="text-xs"><summary class="cursor-pointer text-gray-500 hover:text-gray-700"> </summary> <pre class="mt-2 whitespace-pre-wrap text-xs bg-white p-2 rounded shadow-sm overflow-x-auto"> </pre></details></div>'),is=v('<div class="space-y-4"><h3 class="text-lg font-medium leading-6 text-gray-900"> </h3> <form class="space-y-4"><div><label for="query-text" class="block text-sm font-medium text-gray-700"> </label> <textarea id="query-text" rows="3" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring-[#2271b3] focus:border-[#2271b3] sm:text-sm" required></textarea></div> <div><button type="submit" class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-[#2271b3] hover:bg-[#195a91] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#2271b3] disabled:opacity-50" style="background-color: #2271b3;"><!></button></div></form> <!> <!> <!></div>'),ds=v('<div><div class="px-4 py-5 sm:px-6 border-b border-gray-200"><h3 class="text-lg leading-6 font-medium text-gray-900"> </h3> <p class="mt-1 max-w-2xl text-sm text-gray-500"> </p></div> <div class="border-b border-gray-200"><dl><div class="bg-gray-50 px-4 py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"><dt class="text-sm font-medium text-gray-500"> </dt> <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"> </dd></div> <!> <!> <!></dl></div> <div class="border-t border-gray-200"><div class="border-b border-gray-200"><nav class="-mb-px flex space-x-8 px-4 sm:px-6" aria-label="Tabs"><button type="button"> </button> <button type="button"> </button> <button> </button></nav></div> <div class="px-4 py-5 sm:px-6"><!> <!> <!></div></div></div>'),ns=v('<div class="p-6 text-center text-gray-500"> </div>'),vs=v('<div class="bg-white shadow overflow-hidden sm:rounded-lg"><!></div>');function us(b,u){oa(u,!0);const[x,st]=da(),o=()=>Wt(na,"$_",x);let c=Ua(u,"kbId",3,""),_=k(null),X=k(!0),j=k(""),Z=k(!1),E=k("files"),Q=k(ha([])),_e=k(!1),ne=k(""),M=k(null),ze=k(0),q=k(ha({})),ee=k(null),Fe=k(!1),h=k(""),O=k(!1),R="",ve=k(""),D=k(null),L=k(!1),ue=k("");Ba(()=>(console.log("KnowledgeBaseDetail mounted, kbId:",c()),R=c(),()=>{console.log("KnowledgeBaseDetail unmounted")})),Sa(()=>{console.log("Effect running. kbId:",c(),"previousKbId:",R,"kb:",a(_)!==null),c()&&(c()!==R||a(_)===null)?(console.log("Condition met: Loading knowledge base for kbId:",c()),Me(c()),R=c()):(console.log("Condition not met: Skipping loadKnowledgeBase."),!c()&&a(_)!==null&&(console.log("kbId is empty, resetting kb state."),l(_,null),R=""),c()!==R&&(R=c()))});function Pe(d){console.log("Selecting tab:",d),l(E,d,!0),d==="ingest"&&a(Q).length===0&&!a(_e)&&(console.log("Ingest tab selected, fetching plugins."),y()),l(h,""),l(O,!1),d!=="ingest"&&(l(ee,null),Le()),l(ve,""),l(D,null),l(ue,""),l(L,!1)}function Le(){const d=document.querySelector("#file-upload-input-inline");d&&(d.value="")}async function Me(d){a(_)||l(X,!0),l(j,""),l(Z,!1);try{const g=await za(d);l(_,g,!0),console.log("Knowledge base details loaded:",a(_))}catch(g){console.error("Error loading knowledge base details:",g),l(j,g instanceof Error?g.message:"Failed to load knowledge base details",!0),g instanceof Error&&g.message.includes("server offline")&&l(Z,!0)}finally{l(X,!1)}}function Ve(d){if(d==null)return"N/A";const g=["B","KB","MB","GB"];let p=d,w=0;for(;p>=1024&&w<g.length-1;)p/=1024,w++;return`${p.toFixed(1)} ${g[w]}`}function Gt(d){console.log(`Delete file requested: ${d}`),alert(o()("knowledgeBases.detail.fileDeleteNotImplemented",{default:"File delete functionality not yet implemented"}))}async function y(){l(_e,!0),l(ne,"");try{l(Q,await Ma(),!0),console.log("Fetched plugins:",a(Q)),a(Q).length>0&&oe(0)}catch(d){console.error("Error fetching plugins:",d),l(ne,d instanceof Error?d.message:"Failed to load ingestion plugins",!0),d instanceof Error&&d.message.includes("server offline")&&l(Z,!0)}finally{l(_e,!1)}}function oe(d){var g;if(d>=0&&d<a(Q).length){if(l(ze,d,!0),l(M,a(Q)[d],!0),l(q,{},!0),a(M)&&a(M).parameters)for(const p in a(M).parameters)a(q)[p]=a(M).parameters[p].default;console.log("Selected plugin:",(g=a(M))==null?void 0:g.name,"with params:",a(q))}}function te(d,g){var F,A;const p=g.target,w=(A=(F=a(M))==null?void 0:F.parameters)==null?void 0:A[d];w&&(w.type==="integer"||w.type==="number"?a(q)[d]=p.value?Number(p.value):w.default:w.type==="boolean"?a(q)[d]=p.checked:a(q)[d]=p.value,console.log(`Updated param ${d} to:`,a(q)[d]))}async function Oe(){var d,g;if(console.log("uploadFile called, selectedFile:",(d=a(ee))==null?void 0:d.name,"selectedPlugin:",(g=a(M))==null?void 0:g.name),!a(ee)||!a(M)){l(h,"Please select a file and plugin."),console.warn("Upload aborted: missing file or plugin");return}l(Fe,!0),l(h,""),l(O,!1),console.log("Upload parameters:",{kbId:c(),fileName:a(ee).name,fileSize:a(ee).size,fileType:a(ee).type,pluginName:a(M).name,pluginParams:a(q)});try{const p=await Oa(c(),a(ee),a(M).name,a(q));console.log("Upload result:",p),l(O,!0),l(ee,null),Le(),await Me(c())}catch(p){console.error("Error uploading file:",p),l(h,p instanceof Error?p.message:"Failed to upload file",!0),p instanceof Error&&p.message.includes("server offline")&&l(Z,!0)}finally{l(Fe,!1)}}async function he(){var g,p,w,F;if(!a(ve).trim()||!c())return;const d=localStorage.getItem("userToken");if(!d){l(ue,"User not authenticated. Please log in.");return}l(L,!0),l(ue,""),l(D,null);try{const A=Va(`/knowledgebases/kb/${c()}/query`),T={query_text:a(ve),plugin_name:"simple_query",plugin_params:{top_k:3,threshold:0}};console.log("Sending query request:",{url:A,body:T});const be=await Ja.post(A,T,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},withCredentials:!0});console.log("Query response received:",be.data);const H=((g=be.data.results)==null?void 0:g.map(ie=>{const{source:W,...xe}=ie.metadata||{};return{...ie,metadata:xe}}))||[];l(D,{...be.data,results:H},!0)}catch(A){console.error("Error performing query:",A);const T=A;l(ue,((w=(p=T.response)==null?void 0:p.data)==null?void 0:w.detail)||(T instanceof Error?T.message:"An unknown error occurred during query."),!0),(((F=T.response)==null?void 0:F.status)===503||T instanceof Error&&T.message.includes("server offline"))&&l(Z,!0)}finally{l(L,!1)}}var Ee=vs(),Re=t(Ee);{var ht=d=>{var g=mr(),p=t(g),w=t(p,!0);e(p),e(g),n(F=>r(w,F),[()=>o()("knowledgeBases.detail.loading",{default:"Loading knowledge base details..."})]),i(d,g)},pe=(d,g)=>{{var p=F=>{var A=xr(),T=t(A),be=t(T);{var H=ae=>{var ke=_r(),He=t(ke),Be=t(He,!0);e(He);var N=s(He,2),$e=t(N,!0);e(N),e(ke),n((Ke,Te)=>{r(Be,Ke),r($e,Te)},[()=>o()("knowledgeBases.detail.serverOffline",{default:"Knowledge Base Server Offline"}),()=>o()("knowledgeBases.detail.tryAgainLater",{default:"Please try again later or contact an administrator."})]),i(ae,ke)},ie=ae=>{var ke=wt();n(()=>r(ke,a(j))),i(ae,ke)};f(be,ae=>{a(Z)?ae(H):ae(ie,!1)})}e(T);var W=s(T,2);W.__click=[br,Me,c];var xe=t(W,!0);e(W),e(A),n(ae=>r(xe,ae),[()=>o()("knowledgeBases.detail.retry",{default:"Retry"})]),i(F,A)},w=(F,A)=>{{var T=H=>{var ie=ds(),W=t(ie),xe=t(W),ae=t(xe,!0);e(xe);var ke=s(xe,2),He=t(ke,!0);e(ke),e(W);var Be=s(W,2),N=t(Be),$e=t(N),Ke=t($e),Te=t(Ke,!0);e(Ke);var vt=s(Ke,2),Ut=t(vt,!0);e(vt),e($e);var We=s($e,2);{var Yt=I=>{var $=yr(),z=t($),Ie=t(z,!0);e(z);var re=s(z,2),G=t(re,!0);e(re),e($),n(se=>{r(Ie,se),r(G,a(_).owner)},[()=>o()("knowledgeBases.detail.ownerLabel",{default:"Owner"})]),i(I,$)};f(We,I=>{a(_).owner&&I(Yt)})}var ut=s(We,2);{var At=I=>{var $=wr(),z=t($),Ie=t(z,!0);e(z);var re=s(z,2),G=t(re,!0);e(re),e($),n((se,de)=>{r(Ie,se),r(G,de)},[()=>o()("knowledgeBases.detail.createdLabel",{default:"Created"}),()=>new Date(a(_).created_at*1e3).toLocaleString()]),i(I,$)};f(ut,I=>{a(_).created_at&&I(At)})}var ct=s(ut,2);{var kt=I=>{var $=hr(),z=t($),Ie=t(z,!0);e(z);var re=s(z,2),G=t(re),se=t(G,!0);e(G),e(re),e($),n(de=>{r(Ie,de),Vt(G,1,`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${a(_).metadata.access_control==="private"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`),r(se,a(_).metadata.access_control)},[()=>o()("knowledgeBases.detail.accessLabel",{default:"Access Control"})]),i(I,$)};f(ct,I=>{var $;($=a(_).metadata)!=null&&$.access_control&&I(kt)})}e(N),e(Be);var C=s(Be,2),J=t(C),me=t(J),De=t(me);De.__click=[kr,Pe];var Xt=t(De,!0);e(De);var Ue=s(De,2);Ue.__click=[Br,Pe];var ft=t(Ue,!0);e(Ue);var Ge=s(Ue,2);Ge.__click=[$r,Pe];var gt=t(Ge,!0);e(Ge),e(me),e(J);var Nt=s(J,2),Bt=t(Nt);{var va=I=>{var $=Ir(),z=t($);{var Ie=G=>{var se=Kr(),de=t(se),Ye=t(de),$t=t(Ye),lt=t($t),ot=t(lt,!0);e(lt);var qt=s(lt),Zt=t(qt,!0);e(qt);var pt=s(qt),it=t(pt,!0);e(pt);var Xe=s(pt),zt=t(Xe,!0);e(Xe),e($t),e(Ye);var Mt=s(Ye);Jt(Mt,21,()=>a(_).files,Ze=>Ze.id,(Ze,m)=>{var K=Er(),U=t(K),et=t(U),Ae=t(et),Ct=t(Ae);{var St=Ce=>{var we=qr(),Kt=t(we,!0);e(we),n(()=>{le(we,"href",a(m).file_url),r(Kt,a(m).filename)}),i(Ce,we)},Ot=Ce=>{var we=Cr(),Kt=t(we,!0);e(we),n(()=>r(Kt,a(m).filename)),i(Ce,we)};f(Ct,Ce=>{a(m).file_url?Ce(St):Ce(Ot,!1)})}e(Ae),e(et),e(U);var je=s(U),mt=t(je),Rt=t(mt,!0);e(mt),e(je);var _t=s(je),ye=t(_t),qe=t(ye,!0);e(ye),e(_t);var tt=s(_t),ce=t(tt);ce.__click=[Sr,Gt,m];var Et=t(ce,!0);e(ce),e(tt),e(K),n((Ce,we)=>{r(Rt,Ce),r(qe,a(m).content_type||"Unknown"),r(Et,we)},[()=>a(m).size?Ve(a(m).size):"N/A",()=>o()("knowledgeBases.detail.fileDeleteButton",{default:"Delete"})]),i(Ze,K)}),e(Mt),e(de),e(se),n((Ze,m,K,U)=>{r(ot,Ze),r(Zt,m),r(it,K),r(zt,U)},[()=>o()("knowledgeBases.detail.fileNameColumn",{default:"File Name"}),()=>o()("knowledgeBases.detail.fileSizeColumn",{default:"Size"}),()=>o()("knowledgeBases.detail.fileTypeColumn",{default:"Type"}),()=>o()("knowledgeBases.detail.fileActionsColumn",{default:"Actions"})]),i(G,se)},re=G=>{var se=Dr(),de=t(se,!0);e(se),n(Ye=>r(de,Ye),[()=>o()("knowledgeBases.detail.noFiles",{default:"No files have been uploaded to this knowledge base."})]),i(G,se)};f(z,G=>{a(_).files&&a(_).files.length>0?G(Ie):G(re,!1)})}e($),i(I,$)};f(Bt,I=>{a(E)==="files"&&I(va)})}var ta=s(Bt,2);{var ua=I=>{var $=Zr(),z=t($),Ie=t(z,!0);e(z);var re=s(z,2);{var G=de=>{},se=(de,Ye)=>{{var $t=ot=>{},lt=(ot,qt)=>{{var Zt=it=>{},pt=it=>{var Xe=Xr(),zt=t(Xe);{var Mt=B=>{var S=Fr(),Y=t(S),fe=t(Y,!0);e(Y),e(S),n(Dt=>r(fe,Dt),[()=>o()("knowledgeBases.fileUpload.success",{default:"File uploaded and ingestion started successfully!"})]),i(B,S)};f(zt,B=>{a(O)&&B(Mt)})}var Ze=s(zt,2);{var m=B=>{var S=Pr(),Y=t(S),fe=t(Y,!0);e(Y),e(S),n(()=>r(fe,a(h))),i(B,S)};f(Ze,B=>{a(h)&&B(m)})}var K=s(Ze,2),U=t(K),et=t(U,!0);e(U);var Ae=s(U,2),Ct=t(Ae);Ct.__change=[pr,ee,O,h],e(Ae);var St=s(Ae,2);{var Ot=B=>{var S=Lr(),Y=t(S);e(S),n(fe=>r(Y,`${a(ee).name??""} (${fe??""})`),[()=>Ve(a(ee).size)]),i(B,S)};f(St,B=>{a(ee)&&B(Ot)})}e(K);var je=s(K,2),mt=t(je),Rt=t(mt,!0);e(mt);var _t=s(mt,2),ye=t(_t);ye.__change=[Tr,oe],Jt(ye,21,()=>a(Q),ba,(B,S,Y)=>{var fe=Ur();fe.value=(fe.__value=Y)??"";var Dt=t(fe);e(fe),n(()=>{$a(fe,Y===a(ze)),r(Dt,`${a(S).name??""} - ${a(S).description??""}`)}),i(B,fe)}),e(ye),e(_t),e(je);var qe=s(je,2);{var tt=B=>{var S=Yr(),Y=t(S),fe=t(Y,!0);e(Y);var Dt=s(Y,2);Jt(Dt,17,()=>Object.entries(a(M).parameters),([dt,It])=>dt,(dt,It)=>{let P=()=>a(It)[0],V=()=>a(It)[1];var ea=Gr(),Ft=t(ea),jt=t(Ft),ga=s(jt);{var aa=Se=>{var ge=Ar(),bt=t(ge);e(ge),n(()=>r(bt,`(${V().description??""})`)),i(Se,ge)};f(ga,Se=>{V().description&&Se(aa)})}e(Ft);var ra=s(Ft,2),Pt=t(ra);{var at=Se=>{var ge=Mr();ja(ge,()=>a(q)[P()]);var bt;ge.__change=[Nr,te,P],Jt(ge,21,()=>V().enum,ba,(pa,Je)=>{var Ne=zr(),rt={},Lt=t(Ne,!0);e(Ne),n(()=>{rt!==(rt=a(Je))&&(Ne.value=(Ne.__value=a(Je))??""),$a(Ne,a(q)[P()]===a(Je)),r(Lt,a(Je))}),i(pa,Ne)}),e(ge),n(()=>{le(ge,"id",`param-${P()}-inline`),bt!==(bt=a(q)[P()])&&(ge.value=(ge.__value=a(q)[P()])??"",Qa(ge,a(q)[P()]))}),i(Se,ge)},Qe=(Se,ge)=>{{var bt=Je=>{var Ne=Rr(),rt=t(Ne);Ht(rt),rt.__change=[Or,te,P];var Lt=s(rt,2),xt=t(Lt);e(Lt),e(Ne),n(()=>{le(rt,"id",`param-${P()}-inline`),La(rt,a(q)[P()]===!0),le(Lt,"for",`param-${P()}-inline`),r(xt,`${V().default?"Enabled":"Disabled"} by default`)}),i(Je,Ne)},pa=(Je,Ne)=>{{var rt=xt=>{var yt=Qr();Ht(yt),yt.__change=[jr,te,P],n(ma=>{le(yt,"id",`param-${P()}-inline`),_a(yt,a(q)[P()]),le(yt,"placeholder",ma)},[()=>V().default!==void 0&&V().default!==null?V().default.toString():""]),i(xt,yt)},Lt=(xt,yt)=>{{var ma=Qt=>{var nt=Vr(),Tt=sa(nt);ya(Tt),Tt.__change=[Jr,te,P],Pa(2),n(Ia=>{le(Tt,"id",`param-${P()}-inline`),_a(Tt,Ia),le(Tt,"placeholder",V().description||"Enter values, one per line")},[()=>Array.isArray(a(q)[P()])?a(q)[P()].join(`
`):a(q)[P()]||""]),i(Qt,nt)},Da=Qt=>{var nt=Wr();Ht(nt),nt.__change=[Hr,te,P],n(Tt=>{le(nt,"id",`param-${P()}-inline`),_a(nt,a(q)[P()]),le(nt,"placeholder",Tt)},[()=>V().default!==void 0&&V().default!==null?V().default.toString():""]),i(Qt,nt)};f(xt,Qt=>{V().type==="array"?Qt(ma):Qt(Da,!1)},yt)}};f(Je,xt=>{V().type==="integer"||V().type==="number"?xt(rt):xt(Lt,!1)},Ne)}};f(Se,Je=>{V().type==="boolean"?Je(bt):Je(pa,!1)},ge)}};f(Pt,Se=>{V().enum&&Array.isArray(V().enum)?Se(at):Se(Qe,!1)})}e(ra),e(ea),n(()=>{le(Ft,"for",`param-${P()}-inline`),r(jt,`${P()??""}
                                                        ${V().required?" *":""} `)}),i(dt,ea)}),e(S),n(dt=>r(fe,dt),[()=>o()("knowledgeBases.fileUpload.parametersLabel",{default:"Plugin Parameters"})]),i(B,S)};f(qe,B=>{a(M)&&a(M).parameters&&Object.keys(a(M).parameters).length>0&&B(tt)})}var ce=s(qe,2),Et=t(ce),Ce=t(Et);{var we=B=>{var S=wt();n(Y=>r(S,Y),[()=>o()("knowledgeBases.fileUpload.uploadingButton",{default:"Uploading..."})]),i(B,S)},Kt=B=>{var S=wt();n(Y=>r(S,Y),[()=>o()("knowledgeBases.fileUpload.uploadButton",{default:"Upload File"})]),i(B,S)};f(Ce,B=>{a(Fe)?B(we):B(Kt,!1)})}e(Et),e(ce),e(Xe),n((B,S)=>{r(et,B),r(Rt,S),Et.disabled=!a(ee)||!a(M)||a(Fe)},[()=>o()("knowledgeBases.fileUpload.fileLabel",{default:"Select File"}),()=>o()("knowledgeBases.fileUpload.pluginLabel",{default:"Ingestion Plugin"})]),wa("submit",Xe,B=>{B.preventDefault(),Oe()}),i(it,Xe)};f(ot,it=>{a(Q).length===0?it(Zt):it(pt,!1)},qt)}};f(de,ot=>{a(ne)?ot($t):ot(lt,!1)},Ye)}};f(re,de=>{a(_e)?de(G):de(se,!1)})}e($),n(de=>r(Ie,de),[()=>o()("knowledgeBases.fileUpload.sectionTitle",{default:"Upload and Ingest New File"})]),i(I,$)};f(ta,I=>{a(E)==="ingest"&&I(ua)})}var ca=s(ta,2);{var fa=I=>{var $=is(),z=t($),Ie=t(z,!0);e(z);var re=s(z,2),G=t(re),se=t(G),de=t(se,!0);e(se);var Ye=s(se,2);ya(Ye),e(G);var $t=s(G,2),lt=t($t),ot=t(lt);{var qt=m=>{var K=wt();n(U=>r(K,U),[()=>o()("knowledgeBases.detail.query.loadingButton",{default:"Querying..."})]),i(m,K)},Zt=m=>{var K=wt();n(U=>r(K,U),[()=>o()("knowledgeBases.detail.query.submitButton",{default:"Submit Query"})]),i(m,K)};f(ot,m=>{a(L)?m(qt):m(Zt,!1)})}e(lt),e($t),e(re);var pt=s(re,2);{var it=m=>{var K=es(),U=t(K,!0);e(K),n(et=>r(U,et),[()=>o()("knowledgeBases.detail.query.loadingResults",{default:"Fetching results..."})]),i(m,K)};f(pt,m=>{a(L)&&m(it)})}var Xe=s(pt,2);{var zt=m=>{var K=ts(),U=t(K),et=t(U,!0);e(U);var Ae=s(U,2),Ct=t(Ae,!0);e(Ae),e(K),n(St=>{r(et,St),r(Ct,a(ue))},[()=>o()("knowledgeBases.detail.query.errorTitle",{default:"Error:"})]),i(m,K)};f(Xe,m=>{a(ue)&&m(zt)})}var Mt=s(Xe,2);{var Ze=m=>{var K=os(),U=t(K),et=t(U,!0);e(U);var Ae=s(U,2);{var Ct=ye=>{var qe=ss();Jt(qe,21,()=>a(D).results,ba,(tt,ce,Et)=>{var Ce=rs(),we=t(Ce);{var Kt=Pt=>{var at=as(),Qe=t(at),Se=s(t(Qe));e(Qe),e(at),n(()=>{le(Qe,"href",a(ce).metadata.file_url),le(Qe,"title",`Open file: ${a(ce).metadata.filename}`),r(Se,` ${a(ce).metadata.filename??""}`)}),i(Pt,at)};f(we,Pt=>{var at,Qe;(at=a(ce).metadata)!=null&&at.file_url&&((Qe=a(ce).metadata)!=null&&Qe.filename)&&Pt(Kt)})}var B=s(we,2),S=t(B),Y=t(S);e(S);var fe=s(S,2),Dt=t(fe);e(fe),e(B);var dt=s(B,2),It=t(dt),P=t(It,!0);e(It);var V=s(It,2),ea=t(V,!0);e(V),e(dt);var Ft=s(dt,2),jt=t(Ft),ga=t(jt,!0);e(jt);var aa=s(jt,2),ra=t(aa,!0);e(aa),e(Ft),e(Ce),n((Pt,at,Qe,Se,ge,bt)=>{r(Y,`${Pt??""} ${Et+1}`),r(Dt,`${at??""} ${Qe??""}`),r(P,Se),r(ea,a(ce).data),r(ga,ge),r(ra,bt)},[()=>o()("knowledgeBases.detail.query.resultItemTitle",{default:"Result"}),()=>o()("knowledgeBases.detail.query.similarityLabel",{default:"Similarity:"}),()=>a(ce).similarity.toFixed(4),()=>o()("knowledgeBases.detail.query.contentLabel",{default:"Content:"}),()=>o()("knowledgeBases.detail.query.metadataLabel",{default:"Metadata:"}),()=>JSON.stringify(a(ce).metadata,null,2)]),i(tt,Ce)}),e(qe),i(ye,qe)},St=ye=>{var qe=ls(),tt=t(qe,!0);e(qe),n(ce=>r(tt,ce),[()=>o()("knowledgeBases.detail.query.noResults",{default:"No relevant results found for your query."})]),i(ye,qe)};f(Ae,ye=>{a(D).results&&a(D).results.length>0?ye(Ct):ye(St,!1)})}var Ot=s(Ae,2),je=t(Ot),mt=t(je,!0);e(je);var Rt=s(je,2),_t=t(Rt,!0);e(Rt),e(Ot),e(K),n((ye,qe,tt)=>{r(et,ye),r(mt,qe),r(_t,tt)},[()=>o()("knowledgeBases.detail.query.resultsTitle",{default:"Query Results:"}),()=>o()("knowledgeBases.detail.query.showRawJson",{default:"Show Raw JSON Response"}),()=>JSON.stringify(a(D),null,2)]),i(m,K)};f(Mt,m=>{a(D)&&m(Ze)})}e($),n((m,K,U)=>{r(Ie,m),r(de,K),lt.disabled=U},[()=>o()("knowledgeBases.detail.query.title",{default:"Query Knowledge Base"}),()=>o()("knowledgeBases.detail.query.inputLabel",{default:"Enter your query:"}),()=>a(L)||!a(ve).trim()]),wa("submit",re,m=>{m.preventDefault(),he()}),ka(Ye,()=>a(ve),m=>l(ve,m)),i(I,$)};f(ca,I=>{a(E)==="query"&&I(fa)})}e(Nt),e(C),e(ie),n((I,$,z,Ie,re)=>{r(ae,a(_).name),r(He,I),r(Te,$),r(Ut,a(_).id),Vt(De,1,`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${a(E)==="files"?"border-[#2271b3] text-[#2271b3]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`),xa(De,a(E)==="files"?"border-color: #2271b3; color: #2271b3;":""),le(De,"aria-current",a(E)==="files"?"page":void 0),r(Xt,z),Vt(Ue,1,`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${a(E)==="ingest"?"border-[#2271b3] text-[#2271b3]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`),xa(Ue,a(E)==="ingest"?"border-color: #2271b3; color: #2271b3;":""),le(Ue,"aria-current",a(E)==="ingest"?"page":void 0),r(ft,Ie),Vt(Ge,1,`${a(E)==="query"?"border-brand text-brand":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`),xa(Ge,a(E)==="query"?"border-color: #2271b3; color: #2271b3;":""),le(Ge,"aria-current",a(E)==="query"?"page":void 0),r(gt,re)},[()=>a(_).description||o()("knowledgeBases.detail.noDescription",{default:"No description provided."}),()=>o()("knowledgeBases.detail.idLabel",{default:"ID"}),()=>o()("knowledgeBases.detail.filesTab",{default:"Files"}),()=>o()("knowledgeBases.detail.ingestTab",{default:"Ingest Content"}),()=>o()("knowledgeBases.detail.tabs.query",{default:"Query"})]),i(H,ie)},be=H=>{var ie=ns(),W=t(ie,!0);e(ie),n(xe=>r(W,xe),[()=>o()("knowledgeBases.detail.noData",{default:"No knowledge base data available."})]),i(H,ie)};f(F,H=>{a(_)?H(T):H(be,!1)},A)}};f(d,F=>{a(j)&&!a(_)?F(p):F(w,!1)},g)}};f(Re,d=>{a(X)?d(ht):d(pe,!1)})}e(Ee),i(b,Ee),ia(),st()}la(["click","change"]);function cs(){console.log("Back to list called"),Ea(`${Ka}/knowledgebases`,{replaceState:!1,keepFocus:!0})}var fs=v('<div class="flex items-center"><button type="button" class="mr-3 inline-flex items-center p-1 border border-transparent rounded-full shadow-sm text-white bg-[#2271b3] hover:bg-[#195a91] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#2271b3]" style="background-color: #2271b3;"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg></button> <h1 class="text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate"> </h1></div> <p class="mt-1 text-sm text-gray-500"> </p>',1),gs=v('<h1 class="text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate"> </h1> <p class="mt-1 text-sm text-gray-500"> </p>',1),ps=v('<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"><div class="pb-5 border-b border-gray-200"><!></div> <div class="mt-6"><!></div></div>');function Fs(b,u){oa(u,!0);const[x,st]=da(),o=()=>Wt(Ha,"$page",x),c=()=>Wt(na,"$_",x);let _=k("list"),X=k("");Ba(()=>{console.log("KnowledgeBases page mounted"),j()});function j(){const h=o().url.searchParams,O=h.get("view"),R=h.get("id");l(_,O==="detail"&&R?"detail":"list",!0),l(X,a(_)==="detail"&&R||"",!0),console.log("State updated from URL - view:",a(_),"kbId:",a(X))}Sa(()=>{o().url&&j()});function Z(h){const O=h.detail.id;console.log("View event received for KB:",O),Ea(`${Ka}/knowledgebases?view=detail&id=${O}`,{replaceState:!1,keepFocus:!0})}var E=ps(),Q=t(E),_e=t(Q);{var ne=h=>{var O=fs(),R=sa(O),ve=t(R);ve.__click=[cs];var D=s(ve,2),L=t(D,!0);e(D),e(R);var ue=s(R,2),Pe=t(ue,!0);e(ue),n((Le,Me,Ve)=>{le(ve,"aria-label",Le),r(L,Me),r(Pe,Ve)},[()=>c()("knowledgeBases.backButton",{default:"Back to knowledge bases list"}),()=>c()("knowledgeBases.detailTitle",{default:"Knowledge Base Details"}),()=>c()("knowledgeBases.detailDescription",{default:"View details and manage files for this knowledge base."})]),i(h,O)},M=h=>{var O=gs(),R=sa(O),ve=t(R,!0);e(R);var D=s(R,2),L=t(D,!0);e(D),n((ue,Pe)=>{r(ve,ue),r(L,Pe)},[()=>c()("knowledgeBases.pageTitle",{default:"Knowledge Bases"}),()=>c()("knowledgeBases.pageDescription",{default:"Manage your knowledge bases for use with learning assistants."})]),i(h,O)};f(_e,h=>{a(_)==="detail"&&a(X)?h(ne):h(M,!1)})}e(Q);var ze=s(Q,2),q=t(ze);{var ee=h=>{us(h,{get kbId(){return a(X)}})},Fe=h=>{gr(h,{$$events:{view:Z}})};f(q,h=>{a(_)==="detail"&&a(X)?h(ee):h(Fe,!1)})}e(ze),e(E),i(b,E),ia(),st()}la(["click"]);export{Fs as component};
