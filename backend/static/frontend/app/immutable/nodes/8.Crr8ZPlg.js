import"../chunks/Bzak7iHL.js";import{v as Pa,w as Oa,a_ as ja,a$ as Qa,b0 as Ja,al as Va,av as Ha,ar as Wa,at as Ya,as as Ga,z as Za,aN as Xa,aA as er,d as ca,p as fa,aY as Ua,k as Qe,l as $e,g as e,s as q,c as i,h as ga,i as l,f as u,j as a,b as o,r as t,aP as Ca,t as d,m as r,e as Ea,q as bt,a as Ia,M as Fa,u as Da,Q as tr,R as ar,o as rr}from"../chunks/D10uF6KO.js";import{i as f}from"../chunks/B5RjaZpx.js";import{r as Xt,s as Zt,a as ie,e as La,d as sr,b as $a}from"../chunks/gDFrtnMu.js";import{s as ma,a as ea}from"../chunks/CAofB27F.js";import{e as Gt,i as qa}from"../chunks/BY88_K0J.js";import{b as lr}from"../chunks/DXcfmTg0.js";import{c as or,g as ir,d as nr,a as dr,b as vr,e as ur,u as cr,r as fr}from"../chunks/XvA01ktp.js";import{$ as pa}from"../chunks/Cct3hKQg.js";import{u as gr}from"../chunks/DSpOhgIp.js";import{b as Aa}from"../chunks/CjgJlaKl.js";import{b as Ka,c as Ta}from"../chunks/CF2p2rhS.js";import{s as Sa}from"../chunks/BPb77SYP.js";import{i as mr,s as pr}from"../chunks/DRu2A6f6.js";import{p as _r}from"../chunks/Dpgw__wX.js";import{a as br}from"../chunks/ngrFHoWO.js";import{g as xr}from"../chunks/BVlmaXU-.js";import{p as yr}from"../chunks/-YgP7Ysb.js";import{g as Na}from"../chunks/5D1vQkJ2.js";function wr(b,c,s){Pa&&Oa();var w=b,me=Xa,B,g,T=null,Q=ja()?Qa:Ja;function H(){B&&er(B),T!==null&&(T.lastChild.remove(),w.before(T),T=null),B=g}Va(()=>{if(Q(me,me=c())){var h=w,z=Ga();z&&(T=document.createDocumentFragment(),T.append(h=Ha())),g=Wa(()=>s(h)),z?Ya.add_callback(H):H()}}),Pa&&(w=Za)}function hr(b,c){b.key==="Escape"&&c()}function kr(b,c){c()}function Br(b){b.stopPropagation()}var $r=u('<div class="mb-4 p-2 bg-red-50 text-red-500 text-sm rounded"> </div>'),qr=u('<p class="mt-1 text-sm text-red-600"> </p>'),Sr=u('<div class="fixed inset-0 z-40 overflow-y-auto"><div class="fixed inset-0 bg-black bg-opacity-50 transition-opacity" aria-hidden="true"></div> <div class="flex min-h-screen items-center justify-center p-4"><div class="relative bg-white rounded-lg shadow-xl max-w-lg w-full mx-auto p-6" tabindex="-1" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="mb-4"><h3 id="modal-title" class="text-lg font-medium text-gray-900"> </h3> <p class="text-sm text-gray-500 mt-1"> </p></div> <!> <form class="space-y-4"><div><label for="kb-name" class="block text-sm font-medium text-gray-700"> </label> <input type="text" id="kb-name"/> <!></div> <div><label for="kb-description" class="block text-sm font-medium text-gray-700"> </label> <textarea id="kb-description" rows="3" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-[#2271b3] focus:border-[#2271b3] sm:text-sm"></textarea></div> <div><fieldset><legend class="block text-sm font-medium text-gray-700"> </legend> <div class="mt-2 space-y-2"><div class="flex items-center"><input id="private" name="accessControl" type="radio" class="h-4 w-4 text-[#2271b3] focus:ring-[#2271b3] border-gray-300"/> <label for="private" class="ml-2 block text-sm text-gray-700"> </label></div> <div class="flex items-center"><input id="public" name="accessControl" type="radio" class="h-4 w-4 text-[#2271b3] focus:ring-[#2271b3] border-gray-300"/> <label for="public" class="ml-2 block text-sm text-gray-700"> </label></div></div> <p class="mt-1 text-xs text-gray-500"> </p></fieldset></div> <div class="mt-5 sm:mt-6 sm:grid sm:grid-cols-2 sm:gap-3 sm:grid-flow-row-dense"><button type="submit" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-[#2271b3] text-base font-medium text-white hover:bg-[#195a91] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#2271b3] sm:col-start-2 sm:text-sm" style="background-color: #2271b3;"><!></button> <button type="button" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:col-start-1 sm:text-sm"> </button></div></form></div></div></div>');function Cr(b,c){fa(c,!0);const s=()=>ea(pa,"$_",w),[w,me]=ma(),B=[],g=Ua();let T=q(!1),Q=q(!1),H=q(""),h=q(""),z=q(""),xe=q("private"),ue=q("");function y(){l(T,!0),E()}function Je(){e(Q)||(l(T,!1),E(),g("close"))}function E(){l(h,""),l(z,""),l(xe,"private"),l(H,""),l(ue,""),l(Q,!1)}function ae(){let M=!0;return l(ue,""),l(H,""),e(h).trim()?e(h).length>50&&(l(ue,s()("knowledgeBases.createModal.nameTooLong",{default:"Name must be less than 50 characters"}),!0),M=!1):(l(ue,s()("knowledgeBases.createModal.nameRequired",{default:"Name is required"}),!0),M=!1),M}async function Ne(M){if(M.preventDefault(),!!ae()){l(Q,!0),l(H,"");try{const U=await or({name:e(h).trim(),description:e(z).trim()||void 0,access_control:e(xe)});console.log("Knowledge base created:",U),l(T,!1),g("created",{id:U.kb_id,name:U.name,message:U.message}),E()}catch(U){console.error("Error creating knowledge base:",U),l(H,U instanceof Error?U.message:"Failed to create knowledge base",!0),l(Q,!1)}}}var x={open:y},A=Qe(),R=$e(A);{var pe=M=>{var U=Sr(),Ke=a(U);Ke.__click=[kr,Je];var vt=o(Ke,2),ye=a(vt);ye.__click=[Br],ye.__keydown=[hr,Je];var et=a(ye),Ct=a(et),ta=a(Ct,!0);t(Ct);var p=o(Ct,2),F=a(p,!0);t(p),t(et);var we=o(et,2);{var Ve=D=>{var Z=$r(),Ce=a(Z,!0);t(Z),d(()=>r(Ce,e(H))),i(D,Z)};f(we,D=>{e(H)&&D(Ve)})}var ut=o(we,2),ze=a(ut),qe=a(ze),ct=a(qe);t(qe);var He=o(qe,2);Xt(He);var Et=o(He,2);{var n=D=>{var Z=qr(),Ce=a(Z,!0);t(Z),d(()=>r(Ce,e(ue))),i(D,Z)};f(Et,D=>{e(ue)&&D(n)})}t(ze);var v=o(ze,2),_=a(v),$=a(_,!0);t(_);var N=o(_,2);Ca(N),t(v);var P=o(v,2),J=a(P),te=a(J),We=a(te,!0);t(te);var _e=o(te,2),ce=a(_e),V=a(ce);Xt(V),V.value=V.__value="private";var Re=o(V,2),se=a(Re,!0);t(Re),t(ce);var Fe=o(ce,2),he=a(Fe);Xt(he),he.value=he.__value="public";var Me=o(he,2),G=a(Me,!0);t(Me),t(Fe),t(_e);var Pe=o(_e,2),Le=a(Pe,!0);t(Pe),t(J),t(P);var Se=o(P,2),tt=a(Se),Ut=a(tt);{var At=D=>{var Z=bt();d(Ce=>r(Z,Ce),[()=>s()("knowledgeBases.creating",{default:"Creating..."})]),i(D,Z)},Nt=D=>{var Z=bt();d(Ce=>r(Z,Ce),[()=>s()("knowledgeBases.create",{default:"Create Knowledge Base"})]),i(D,Z)};f(Ut,D=>{e(Q)?D(At):D(Nt,!1)})}t(tt);var at=o(tt,2);at.__click=Je;var It=a(at,!0);t(at),t(Se),t(ut),t(ye),t(vt),t(U),d((D,Z,Ce,zt,ft,xt,Ye,Rt,Ee,aa,Te)=>{r(ta,D),r(F,Z),r(ct,`${Ce??""} *`),Zt(He,1,`mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-[#2271b3] focus:border-[#2271b3] sm:text-sm ${e(ue)?"border-red-300 focus:ring-red-500 focus:border-red-500":""}`),ie(He,"placeholder",zt),r($,ft),ie(N,"placeholder",xt),r(We,Ye),r(se,Rt),r(G,Ee),r(Le,aa),tt.disabled=e(Q),at.disabled=e(Q),r(It,Te)},[()=>s()("knowledgeBases.createPageTitle",{default:"Create Knowledge Base"}),()=>s()("knowledgeBases.createModal.description",{default:"Create a new knowledge base to store and retrieve documents."}),()=>s()("knowledgeBases.name",{default:"Name"}),()=>s()("knowledgeBases.namePlaceholder",{default:"Enter knowledge base name"}),()=>s()("knowledgeBases.description",{default:"Description"}),()=>s()("knowledgeBases.descriptionPlaceholder",{default:"Enter a description for this knowledge base"}),()=>s()("knowledgeBases.accessControl",{default:"Access Control"}),()=>s()("knowledgeBases.private",{default:"Private"}),()=>s()("knowledgeBases.public",{default:"Public"}),()=>s()("knowledgeBases.accessControlHelp",{default:"Private knowledge bases are only accessible by you, while public ones can be accessed by other users."}),()=>s()("knowledgeBases.cancel",{default:"Cancel"})]),Ea("submit",ut,Ne),Ka(He,()=>e(h),D=>l(h,D)),Ka(N,()=>e(z),D=>l(z,D)),Ta(B,[],V,()=>e(xe),D=>l(xe,D)),Ta(B,[],he,()=>e(xe),D=>l(xe,D)),i(M,U)};f(R,M=>{e(T)&&M(pe)})}i(b,A);var re=ga(x);return me(),re}ca(["click","keydown"]);var Er=u('<div class="p-4 bg-green-50 border-b border-green-100"><div class="text-sm text-green-700"> </div></div>'),Ir=u('<div class="p-6 text-center"><div class="animate-pulse text-gray-500"> </div></div>'),Dr=u('<div><p class="font-bold mb-2"> </p> <p> </p></div>'),Kr=(b,c)=>c(),Fr=u('<div class="p-6 text-center"><div class="text-red-500"><!></div> <button class="mt-4 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-[#2271b3] hover:bg-[#195a91] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#2271b3]" style="background-color: #2271b3;"> </button></div>'),Pr=u('<div class="p-6 text-center"><div class="text-gray-500"> </div></div>'),Lr=(b,c,s)=>c(e(s).id),Tr=(b,c,s)=>c(e(s).id),Ur=(b,c,s)=>c(e(s).id),Ar=(b,c,s)=>c(e(s)),Nr=u('<tr><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm font-medium text-gray-900"><button type="button" class="text-[#2271b3] hover:text-[#195a91] hover:underline text-left font-medium p-0 bg-transparent border-0 cursor-pointer" style="color: #2271b3;"> </button></div> <div class="text-sm text-gray-500"> </div></td><td class="px-6 py-4 whitespace-normal"><div class="text-sm text-gray-900"> </div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900"> </div></td><td class="px-6 py-4 whitespace-nowrap"><span> </span></td><td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"><button class="text-[#2271b3] hover:text-[#195a91] mr-2" style="color: #2271b3;"> </button> <button type="button" class="text-[#2271b3] hover:text-[#195a91] mr-2" style="color: #2271b3;"> </button> <button type="button" class="text-red-600 hover:text-red-900"> </button></td></tr>'),zr=u('<div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> </th><th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"> </th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div>'),Rr=u('<div class="bg-white shadow overflow-hidden sm:rounded-md"><div class="p-4 border-b border-gray-200 sm:flex sm:items-center sm:justify-between"><h3 class="text-lg leading-6 font-medium text-gray-900"> </h3> <div class="mt-3 sm:mt-0 sm:ml-4"><button class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-[#2271b3] hover:bg-[#195a91] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#2271b3]" style="background-color: #2271b3;"> </button></div></div> <!> <!> <!></div>');function Mr(b,c){fa(c,!0);const s=()=>ea(gr,"$user",me),w=()=>ea(pa,"$_",me),[me,B]=ma();let g=q(Ia([])),T=q(!0),Q=q(""),H=q(!1),h=q(""),z;const xe=Ua();Fa(async()=>{await ue()});async function ue(){l(T,!0),l(Q,""),l(H,!1);try{if(!s().isLoggedIn){l(Q,"You must be logged in to view knowledge bases."),l(T,!1);return}const p=await ir();l(g,p||[],!0),console.log("Knowledge bases loaded:",e(g).length)}catch(p){console.error("Error loading knowledge bases:",p),l(Q,p instanceof Error?p.message:"Failed to load knowledge bases",!0),p instanceof Error&&p.message.includes("server offline")&&l(H,!0)}finally{l(T,!1)}}function y(p){return p?new Date(p*1e3).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}function Je(){z.open()}function E(p){xe("view",{id:p})}async function ae(p){if(p&&confirm(w()("knowledgeBases.list.confirmDelete",{default:`Delete knowledge base "${p.name}" and all its data? This cannot be undone.`})))try{await nr(p.id),l(g,e(g).filter(F=>F.id!==p.id),!0),l(h,w()("knowledgeBases.list.deleteSuccess",{default:"Knowledge base deleted."}),!0),setTimeout(()=>{l(h,"")},4e3)}catch(F){alert(F instanceof Error?F.message:"Deletion failed")}}function Ne(p){const{id:F,name:we,message:Ve}=p.detail;l(h,Ve||w()("knowledgeBases.createSuccess",{values:{name:we},default:`Knowledge base "${we}" created successfully!`}),!0),setTimeout(()=>{l(h,"")},5e3),ue()}var x=Rr(),A=a(x),R=a(A),pe=a(R,!0);t(R);var re=o(R,2),M=a(re);M.__click=Je;var U=a(M,!0);t(M),t(re),t(A);var Ke=o(A,2);{var vt=p=>{var F=Er(),we=a(F),Ve=a(we,!0);t(we),t(F),d(()=>r(Ve,e(h))),i(p,F)};f(Ke,p=>{e(h)&&p(vt)})}var ye=o(Ke,2);{var et=p=>{var F=Ir(),we=a(F),Ve=a(we,!0);t(we),t(F),d(ut=>r(Ve,ut),[()=>w()("knowledgeBases.list.loading",{default:"Loading knowledge bases..."})]),i(p,F)},Ct=p=>{var F=Qe(),we=$e(F);{var Ve=ze=>{var qe=Fr(),ct=a(qe),He=a(ct);{var Et=$=>{var N=Dr(),P=a(N),J=a(P,!0);t(P);var te=o(P,2),We=a(te,!0);t(te),t(N),d((_e,ce)=>{r(J,_e),r(We,ce)},[()=>w()("knowledgeBases.list.serverOffline",{default:"Knowledge Base Server Offline"}),()=>w()("knowledgeBases.list.tryAgainLater",{default:"Please try again later or contact an administrator."})]),i($,N)},n=$=>{var N=bt();d(()=>r(N,e(Q))),i($,N)};f(He,$=>{e(H)?$(Et):$(n,!1)})}t(ct);var v=o(ct,2);v.__click=[Kr,ue];var _=a(v,!0);t(v),t(qe),d($=>r(_,$),[()=>w()("knowledgeBases.list.retry",{default:"Retry"})]),i(ze,qe)},ut=ze=>{var qe=Qe(),ct=$e(qe);{var He=n=>{var v=Pr(),_=a(v),$=a(_,!0);t(_),t(v),d(N=>r($,N),[()=>w()("knowledgeBases.list.empty",{default:"No knowledge bases found."})]),i(n,v)},Et=n=>{var v=zr(),_=a(v),$=a(_),N=a($),P=a(N),J=a(P,!0);t(P);var te=o(P),We=a(te,!0);t(te);var _e=o(te),ce=a(_e,!0);t(_e);var V=o(_e),Re=a(V,!0);t(V);var se=o(V),Fe=a(se,!0);t(se),t(N),t($);var he=o($);Gt(he,21,()=>e(g),Me=>Me.id,(Me,G)=>{var Pe=Nr(),Le=a(Pe),Se=a(Le),tt=a(Se);tt.__click=[Lr,E,G];var Ut=a(tt,!0);t(tt),t(Se);var At=o(Se,2),Nt=a(At,!0);t(At),t(Le);var at=o(Le),It=a(at),D=a(It,!0);t(It),t(at);var Z=o(at),Ce=a(Z),zt=a(Ce,!0);t(Ce),t(Z);var ft=o(Z),xt=a(ft),Ye=a(xt,!0);t(xt),t(ft);var Rt=o(ft),Ee=a(Rt);Ee.__click=[Tr,E,G];var aa=a(Ee,!0);t(Ee);var Te=o(Ee,2);Te.__click=[Ur,E,G];var _a=a(Te,!0);t(Te);var Mt=o(Te,2);Mt.__click=[Ar,ae,G];var ia=a(Mt,!0);t(Mt),t(Rt),t(Pe),d((ba,na,xa,ya)=>{var da,K;r(Ut,e(G).name),r(Nt,e(G).id),r(D,e(G).description||"-"),r(zt,ba),Zt(xt,1,`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${((da=e(G).metadata)==null?void 0:da.access_control)==="private"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`),r(Ye,((K=e(G).metadata)==null?void 0:K.access_control)||"public"),r(aa,na),r(_a,xa),r(ia,ya)},[()=>y(e(G).created_at),()=>w()("knowledgeBases.list.viewButton",{default:"View"}),()=>w()("knowledgeBases.list.editButton",{default:"Edit"}),()=>w()("knowledgeBases.list.deleteButton",{default:"Delete"})]),i(Me,Pe)}),t(he),t(_),t(v),d((Me,G,Pe,Le,Se)=>{r(J,Me),r(We,G),r(ce,Pe),r(Re,Le),r(Fe,Se)},[()=>w()("knowledgeBases.list.nameColumn",{default:"Name"}),()=>w()("knowledgeBases.list.descriptionColumn",{default:"Description"}),()=>w()("knowledgeBases.list.createdColumn",{default:"Created"}),()=>w()("knowledgeBases.list.accessColumn",{default:"Access"}),()=>w()("knowledgeBases.list.actionsColumn",{default:"Actions"})]),i(n,v)};f(ct,n=>{e(g).length===0?n(He):n(Et,!1)},!0)}i(ze,qe)};f(we,ze=>{e(Q)?ze(Ve):ze(ut,!1)},!0)}i(p,F)};f(ye,p=>{e(T)?p(et):p(Ct,!1)})}var ta=o(ye,2);lr(Cr(ta,{$$events:{created:Ne}}),p=>z=p,()=>z),t(x),d((p,F)=>{r(pe,p),r(U,F)},[()=>w()("knowledgeBases.list.title",{default:"Knowledge Bases"}),()=>w()("knowledgeBases.list.createButton",{default:"Create Knowledge Base"})]),i(b,x),ga(),B()}ca(["click"]);function Or(b,c,s,w){const me=b.target;me.files&&me.files.length>0?(l(c,me.files[0],!0),l(s,!1),l(w,""),console.log("Selected file:",e(c).name,e(c).type,e(c).size)):l(c,null)}var jr=u('<div class="p-6 text-center"><div class="animate-pulse text-gray-500"> </div></div>'),Qr=u('<div><p class="font-bold mb-2"> </p> <p> </p></div>'),Jr=(b,c,s)=>c(s()),Vr=u('<div class="p-6 text-center"><div class="text-red-500"><!></div> <button class="mt-4 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-[#2271b3] hover:bg-[#195a91] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#2271b3]" style="background-color: #2271b3;"> </button></div>'),Hr=u('<div class="bg-white px-4 py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"><dt class="text-sm font-medium text-gray-500"> </dt> <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"> </dd></div>'),Wr=u('<div class="bg-gray-50 px-4 py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"><dt class="text-sm font-medium text-gray-500"> </dt> <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"> </dd></div>'),Yr=u('<div class="bg-white px-4 py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"><dt class="text-sm font-medium text-gray-500"> </dt> <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"><span> </span></dd></div>'),Gr=(b,c)=>c("files"),Zr=(b,c)=>c("ingest"),Xr=(b,c)=>c("query"),es=u('<a target="_blank" rel="noopener noreferrer" class="text-[#2271b3] hover:text-[#195a91] hover:underline" style="color: #2271b3;"> </a>'),ts=u("<span> </span>"),as=(b,c,s)=>c(e(s).id),rs=u('<tr><td class="px-6 py-4 whitespace-nowrap"><div class="flex items-center"><div class="text-sm font-medium text-gray-900"><!></div></div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900"> </div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900"> </div></td><td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"><button class="text-red-600 hover:text-red-900"> </button></td></tr>'),ss=u('<div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> </th><th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"> </th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div>'),ls=u('<div class="text-center text-gray-500 py-4"> </div>'),os=u("<div><!></div>"),is=u('<div class="p-4 bg-green-50 border border-green-100 rounded"><div class="text-sm text-green-700"> </div></div>'),ns=u('<div class="p-4 bg-red-50 border border-red-100 rounded"><div class="text-sm text-red-700"> </div></div>'),ds=u('<p class="mt-2 text-sm text-gray-500"> </p>'),vs=u('<div><label for="file-upload-input-inline" class="block text-sm font-medium text-gray-700"> </label> <div class="mt-1 flex items-center"><input id="file-upload-input-inline" type="file" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-[#2271b3] file:text-white hover:file:bg-[#195a91]" style="file:background-color: #2271b3;"/></div> <!></div>'),us=(b,c)=>{const s=b.target;s&&s.value&&c(parseInt(s.value))},cs=u("<option> </option>"),fs=u('<span class="text-xs text-gray-500 ml-1"> </span>'),gs=(b,c,s)=>c(s(),b),ms=u("<option> </option>"),ps=u('<select class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#2271b3] focus:border-[#2271b3] sm:text-sm"></select>'),_s=(b,c,s)=>c(s(),b),bs=u('<div class="flex items-center"><input type="checkbox" class="h-4 w-4 text-[#2271b3] focus:ring-[#2271b3] border-gray-300 rounded"/> <label class="ml-2 block text-sm text-gray-900"> </label></div>'),xs=(b,c,s)=>c(s(),b),ys=u('<input type="number" class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#2271b3] focus:border-[#2271b3] sm:text-sm"/>'),ws=(b,c,s)=>c(s(),b),hs=u('<textarea rows="3" class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#2271b3] focus:border-[#2271b3] sm:text-sm"></textarea> <p class="mt-1 text-xs text-gray-500">Enter values separated by new lines.</p>',1),ks=(b,c,s)=>c(s(),b),Bs=u('<input type="text" class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#2271b3] focus:border-[#2271b3] sm:text-sm"/>'),$s=u('<div><label class="block text-sm font-medium text-gray-700"> <!></label> <div class="mt-1"><!></div></div>'),qs=u('<div class="space-y-4 border-t border-gray-200 pt-4"><h5 class="font-medium text-gray-700"> </h5> <!></div>'),Ss=u('<form class="space-y-6"><!> <!> <!> <div><label for="plugin-select-inline" class="block text-sm font-medium text-gray-700"> </label> <div class="mt-1"><select id="plugin-select-inline" class="block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-[#2271b3] focus:border-[#2271b3] sm:text-sm rounded-md"></select></div></div> <!> <div class="pt-4 flex justify-end"><button type="submit" class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-[#2271b3] hover:bg-[#195a91] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#2271b3] disabled:opacity-50" style="background-color: #2271b3;"><!></button></div></form>'),Cs=u('<div class="bg-gray-50 -mx-4 -my-5 sm:-mx-6 px-4 py-5 sm:px-6"><h4 class="text-md font-medium text-gray-700 mb-4"> </h4> <!></div>'),Es=u('<div class="mt-4 p-4 border rounded-md bg-gray-50 text-center text-gray-500"> </div>'),Is=u('<div class="mt-4 p-4 border rounded-md bg-red-50 text-red-700"><p class="font-bold"> </p> <pre class="whitespace-pre-wrap text-sm"> </pre></div>'),Ds=u('<div class="mb-2 text-sm"><a target="_blank" rel="noopener noreferrer" class="text-[#2271b3] hover:text-[#195a91] hover:underline font-medium" style="color: #2271b3;"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline-block mr-1 -mt-0.5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0l-1.5-1.5a2 2 0 112.828-2.828l1.5 1.5a.5.5 0 00.707 0l1.5-1.5a.5.5 0 00-.707-.707l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0l1.5 1.5a.5.5 0 00.707 0l1.5-1.5a.5.5 0 00-.707-.707l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0l-1.5-1.5a2 2 0 112.828-2.828l1.5 1.5a.5.5 0 00.707 0l1.5-1.5a.5.5 0 00-.707-.707l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5a2 2 0 11-2.828-2.828z" clip-rule="evenodd"></path></svg> </a></div>'),Ks=u('<div class="p-4 bg-white rounded-md shadow-sm border border-gray-200"><!> <div class="flex justify-between items-start mb-2"><h5 class="text-sm font-semibold text-[#2271b3]" style="color: #2271b3;"> </h5> <span class="text-xs px-2 py-0.5 rounded-full bg-blue-100 text-blue-800"> </span></div> <div class="text-sm text-gray-700 mb-3"><p class="font-medium mb-1"> </p> <div class="prose prose-sm max-w-none p-2 border rounded bg-gray-50 whitespace-pre-wrap break-words"> </div></div> <div class="text-xs text-gray-500 border-t pt-2"><p class="font-medium mb-1"> </p> <pre class="whitespace-pre-wrap text-xs bg-gray-50 p-2 rounded shadow-inner overflow-x-auto"> </pre></div></div>'),Fs=u('<div class="space-y-6"></div>'),Ps=u('<p class="text-sm text-gray-600"> </p>'),Ls=u('<div class="mt-4 p-4 border rounded-md bg-blue-50 space-y-4"><h4 class="text-md font-medium text-gray-900"> </h4> <!> <details class="text-xs"><summary class="cursor-pointer text-gray-500 hover:text-gray-700"> </summary> <pre class="mt-2 whitespace-pre-wrap text-xs bg-white p-2 rounded shadow-sm overflow-x-auto"> </pre></details></div>'),Ts=u('<div class="space-y-4"><h3 class="text-lg font-medium leading-6 text-gray-900"> </h3> <form class="space-y-4"><div><label for="query-text" class="block text-sm font-medium text-gray-700"> </label> <textarea id="query-text" rows="3" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring-[#2271b3] focus:border-[#2271b3] sm:text-sm" required></textarea></div> <div><button type="submit" class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-[#2271b3] hover:bg-[#195a91] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#2271b3] disabled:opacity-50" style="background-color: #2271b3;"><!></button></div></form> <!> <!> <!></div>'),Us=u('<div><div class="px-4 py-5 sm:px-6 border-b border-gray-200"><h3 class="text-lg leading-6 font-medium text-gray-900"> </h3> <p class="mt-1 max-w-2xl text-sm text-gray-500"> </p></div> <div class="border-b border-gray-200"><dl><div class="bg-gray-50 px-4 py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"><dt class="text-sm font-medium text-gray-500"> </dt> <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"> </dd></div> <!> <!> <!></dl></div> <div class="border-t border-gray-200"><div class="border-b border-gray-200"><nav class="-mb-px flex space-x-8 px-4 sm:px-6" aria-label="Tabs"><button type="button"> </button> <button type="button"> </button> <button> </button></nav></div> <div class="px-4 py-5 sm:px-6"><!> <!> <!></div></div></div>'),As=u('<div class="p-6 text-center text-gray-500"> </div>'),Ns=u('<div class="bg-white shadow overflow-hidden sm:rounded-lg"><!></div>');function zs(b,c){fa(c,!0);const s=()=>ea(pa,"$_",w),[w,me]=ma();let B=_r(c,"kbId",3,""),g=q(null),T=q(!0),Q=q(""),H=q(!1),h=q("files"),z=q(Ia([])),xe=q(!1),ue=q(""),y=q(null),Je=q(0),E=q(Ia({})),ae=q(null);Da(()=>{e(y)&&e(y).kind&&e(y).kind});let Ne=q(!1),x=q(""),A=q(!1),R="",pe=q(""),re=q(null),M=q(!1),U=q("");Fa(()=>(console.log("KnowledgeBaseDetail mounted, kbId:",B()),R=B(),()=>{console.log("KnowledgeBaseDetail unmounted")})),Da(()=>{console.log("Effect running. kbId:",B(),"previousKbId:",R,"kb:",e(g)!==null),B()&&(B()!==R||e(g)===null)?(console.log("Condition met: Loading knowledge base for kbId:",B()),ye(B()),R=B()):(console.log("Condition not met: Skipping loadKnowledgeBase."),!B()&&e(g)!==null&&(console.log("kbId is empty, resetting kb state."),l(g,null),R=""),B()!==R&&(R=B()))});function Ke(n){console.log("Selecting tab:",n),l(h,n,!0),n==="ingest"&&e(z).length===0&&!e(xe)&&(console.log("Ingest tab selected, fetching plugins."),ta()),l(x,""),l(A,!1),n!=="ingest"&&(l(ae,null),vt()),l(pe,""),l(re,null),l(U,""),l(M,!1)}function vt(){const n=document.querySelector("#file-upload-input-inline");n&&(n.value="")}async function ye(n){e(g)||l(T,!0),l(Q,""),l(H,!1);try{const v=await dr(n);l(g,v,!0),console.log("Knowledge base details loaded:",e(g))}catch(v){console.error("Error loading knowledge base details:",v),l(Q,v instanceof Error?v.message:"Failed to load knowledge base details",!0),v instanceof Error&&v.message.includes("server offline")&&l(H,!0)}finally{l(T,!1)}}function et(n){if(n==null)return"N/A";const v=["B","KB","MB","GB"];let _=n,$=0;for(;_>=1024&&$<v.length-1;)_/=1024,$++;return`${_.toFixed(1)} ${v[$]}`}async function Ct(n){if(B()&&confirm(s()("knowledgeBases.detail.confirmDelete",{default:"Delete this file and its embeddings? This cannot be undone."})))try{await ur(B(),n,!0),await ye(B())}catch(v){console.error("Failed to delete file",v),alert(v instanceof Error?v.message:"File deletion failed")}}async function ta(){l(xe,!0),l(ue,"");try{l(z,await vr(),!0),console.log("Fetched plugins:",e(z)),e(z).length>0&&p(0)}catch(n){console.error("Error fetching plugins:",n),l(ue,n instanceof Error?n.message:"Failed to load ingestion plugins",!0),n instanceof Error&&n.message.includes("server offline")&&l(H,!0)}finally{l(xe,!1)}}function p(n){var v;if(n>=0&&n<e(z).length){if(l(Je,n,!0),l(y,e(z)[n],!0),l(E,{},!0),e(y)&&e(y).parameters)for(const _ in e(y).parameters)e(E)[_]=e(y).parameters[_].default;console.log("Selected plugin:",(v=e(y))==null?void 0:v.name,"with params:",e(E))}}function F(n,v){var N,P;const _=v.target,$=(P=(N=e(y))==null?void 0:N.parameters)==null?void 0:P[n];$&&($.type==="integer"||$.type==="number"?e(E)[n]=_.value?Number(_.value):$.default:$.type==="boolean"?e(E)[n]=_.checked:e(E)[n]=_.value,console.log(`Updated param ${n} to:`,e(E)[n]))}async function we(){var n,v;if(console.log("uploadFile called, selectedFile:",(n=e(ae))==null?void 0:n.name,"selectedPlugin:",(v=e(y))==null?void 0:v.name),!e(ae)||!e(y)){l(x,"Please select a file and plugin."),console.warn("Upload aborted: missing file or plugin");return}l(Ne,!0),l(x,""),l(A,!1),console.log("Upload parameters:",{kbId:B(),fileName:e(ae).name,fileSize:e(ae).size,fileType:e(ae).type,pluginName:e(y).name,pluginParams:e(E)});try{const _=await cr(B(),e(ae),e(y).name,e(E));console.log("Upload result:",_),l(A,!0),l(ae,null),vt(),await ye(B())}catch(_){console.error("Error uploading file:",_),l(x,_ instanceof Error?_.message:"Failed to upload file",!0),_ instanceof Error&&_.message.includes("server offline")&&l(H,!0)}finally{l(Ne,!1)}}async function Ve(){var n;if(console.log("runBaseIngestion invoked for plugin:",(n=e(y))==null?void 0:n.name,"params:",e(E)),!e(y)){l(x,"Please select a plugin.");return}if(e(y).kind==="file-ingest"){l(x,"Selected plugin requires a file.");return}l(Ne,!0),l(x,""),l(A,!1);try{const v=await fr(B(),e(y).name,e(E));console.log("Base ingestion result:",v),l(A,!0),await ye(B())}catch(v){console.error("Error running base ingestion:",v),l(x,v instanceof Error?v.message:"Failed to run ingestion plugin",!0)}finally{l(Ne,!1)}}function ut(){if(!e(y)){l(x,"Please select a plugin.");return}e(y).kind==="file-ingest"?we():Ve()}async function ze(){var v,_,$,N;if(!e(pe).trim()||!B())return;const n=localStorage.getItem("userToken");if(!n){l(U,"User not authenticated. Please log in.");return}l(M,!0),l(U,""),l(re,null);try{const P=xr(`/knowledgebases/kb/${B()}/query`),J={query_text:e(pe),plugin_name:"simple_query",plugin_params:{top_k:3,threshold:0}};console.log("Sending query request:",{url:P,body:J});const te=await br.post(P,J,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});console.log("Query response received:",te.data);const We=((v=te.data.results)==null?void 0:v.map(_e=>{const{source:ce,...V}=_e.metadata||{};return{..._e,metadata:V}}))||[];l(re,{...te.data,results:We},!0)}catch(P){console.error("Error performing query:",P);const J=P;l(U,(($=(_=J.response)==null?void 0:_.data)==null?void 0:$.detail)||(J instanceof Error?J.message:"An unknown error occurred during query."),!0),(((N=J.response)==null?void 0:N.status)===503||J instanceof Error&&J.message.includes("server offline"))&&l(H,!0)}finally{l(M,!1)}}var qe=Ns(),ct=a(qe);{var He=n=>{var v=jr(),_=a(v),$=a(_,!0);t(_),t(v),d(N=>r($,N),[()=>s()("knowledgeBases.detail.loading",{default:"Loading knowledge base details..."})]),i(n,v)},Et=n=>{var v=Qe(),_=$e(v);{var $=P=>{var J=Vr(),te=a(J),We=a(te);{var _e=se=>{var Fe=Qr(),he=a(Fe),Me=a(he,!0);t(he);var G=o(he,2),Pe=a(G,!0);t(G),t(Fe),d((Le,Se)=>{r(Me,Le),r(Pe,Se)},[()=>s()("knowledgeBases.detail.serverOffline",{default:"Knowledge Base Server Offline"}),()=>s()("knowledgeBases.detail.tryAgainLater",{default:"Please try again later or contact an administrator."})]),i(se,Fe)},ce=se=>{var Fe=bt();d(()=>r(Fe,e(Q))),i(se,Fe)};f(We,se=>{e(H)?se(_e):se(ce,!1)})}t(te);var V=o(te,2);V.__click=[Jr,ye,B];var Re=a(V,!0);t(V),t(J),d(se=>r(Re,se),[()=>s()("knowledgeBases.detail.retry",{default:"Retry"})]),i(P,J)},N=P=>{var J=Qe(),te=$e(J);{var We=ce=>{var V=Us(),Re=a(V),se=a(Re),Fe=a(se,!0);t(se);var he=o(se,2),Me=a(he,!0);t(he),t(Re);var G=o(Re,2),Pe=a(G),Le=a(Pe),Se=a(Le),tt=a(Se,!0);t(Se);var Ut=o(Se,2),At=a(Ut,!0);t(Ut),t(Le);var Nt=o(Le,2);{var at=K=>{var L=Hr(),X=a(L),be=a(X,!0);t(X);var ee=o(X,2),W=a(ee,!0);t(ee),t(L),d(le=>{r(be,le),r(W,e(g).owner)},[()=>s()("knowledgeBases.detail.ownerLabel",{default:"Owner"})]),i(K,L)};f(Nt,K=>{e(g).owner&&K(at)})}var It=o(Nt,2);{var D=K=>{var L=Wr(),X=a(L),be=a(X,!0);t(X);var ee=o(X,2),W=a(ee,!0);t(ee),t(L),d((le,Oe)=>{r(be,le),r(W,Oe)},[()=>s()("knowledgeBases.detail.createdLabel",{default:"Created"}),()=>new Date(e(g).created_at*1e3).toLocaleString()]),i(K,L)};f(It,K=>{e(g).created_at&&K(D)})}var Z=o(It,2);{var Ce=K=>{var L=Yr(),X=a(L),be=a(X,!0);t(X);var ee=o(X,2),W=a(ee),le=a(W,!0);t(W),t(ee),t(L),d(Oe=>{r(be,Oe),Zt(W,1,`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${e(g).metadata.access_control==="private"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`),r(le,e(g).metadata.access_control)},[()=>s()("knowledgeBases.detail.accessLabel",{default:"Access Control"})]),i(K,L)};f(Z,K=>{var L;(L=e(g).metadata)!=null&&L.access_control&&K(Ce)})}t(Pe),t(G);var zt=o(G,2),ft=a(zt),xt=a(ft),Ye=a(xt);Ye.__click=[Gr,Ke];var Rt=a(Ye,!0);t(Ye);var Ee=o(Ye,2);Ee.__click=[Zr,Ke];var aa=a(Ee,!0);t(Ee);var Te=o(Ee,2);Te.__click=[Xr,Ke];var _a=a(Te,!0);t(Te),t(xt),t(ft);var Mt=o(ft,2),ia=a(Mt);{var ba=K=>{var L=os(),X=a(L);{var be=W=>{var le=ss(),Oe=a(le),rt=a(Oe),Dt=a(rt),ne=a(Dt),Ot=a(ne,!0);t(ne);var Kt=o(ne),ra=a(Kt,!0);t(Kt);var yt=o(Kt),gt=a(yt,!0);t(yt);var wt=o(yt),sa=a(wt,!0);t(wt),t(Dt),t(rt);var jt=o(rt);Gt(jt,21,()=>e(g).files,mt=>mt.id,(mt,m)=>{var I=rs(),O=a(I),st=a(O),Ge=a(st),Ft=a(Ge);{var ht=De=>{var Be=es(),Lt=a(Be,!0);t(Be),d(()=>{ie(Be,"href",e(m).file_url),r(Lt,e(m).filename)}),i(De,Be)},Qt=De=>{var Be=ts(),Lt=a(Be,!0);t(Be),d(()=>r(Lt,e(m).filename)),i(De,Be)};f(Ft,De=>{e(m).file_url?De(ht):De(Qt,!1)})}t(Ge),t(st),t(O);var Ze=o(O),kt=a(Ze),Jt=a(kt,!0);t(kt),t(Ze);var Bt=o(Ze),ke=a(Bt),Ie=a(ke,!0);t(ke),t(Bt);var lt=o(Bt),fe=a(lt);fe.__click=[as,Ct,m];var Pt=a(fe,!0);t(fe),t(lt),t(I),d((De,Be)=>{r(Jt,De),r(Ie,e(m).content_type||"Unknown"),r(Pt,Be)},[()=>e(m).size?et(e(m).size):"N/A",()=>s()("knowledgeBases.detail.fileDeleteButton",{default:"Delete"})]),i(mt,I)}),t(jt),t(Oe),t(le),d((mt,m,I,O)=>{r(Ot,mt),r(ra,m),r(gt,I),r(sa,O)},[()=>s()("knowledgeBases.detail.fileNameColumn",{default:"File Name"}),()=>s()("knowledgeBases.detail.fileSizeColumn",{default:"Size"}),()=>s()("knowledgeBases.detail.fileTypeColumn",{default:"Type"}),()=>s()("knowledgeBases.detail.fileActionsColumn",{default:"Actions"})]),i(W,le)},ee=W=>{var le=ls(),Oe=a(le,!0);t(le),d(rt=>r(Oe,rt),[()=>s()("knowledgeBases.detail.noFiles",{default:"No files have been uploaded to this knowledge base."})]),i(W,le)};f(X,W=>{e(g).files&&e(g).files.length>0?W(be):W(ee,!1)})}t(L),i(K,L)};f(ia,K=>{e(h)==="files"&&K(ba)})}var na=o(ia,2);{var xa=K=>{var L=Qe(),X=$e(L);wr(X,()=>{var be;return(be=e(y))==null?void 0:be.kind},be=>{var ee=Cs(),W=a(ee),le=a(W,!0);t(W);var Oe=o(W,2);{var rt=ne=>{},Dt=ne=>{var Ot=Qe(),Kt=$e(Ot);{var ra=gt=>{},yt=gt=>{var wt=Qe(),sa=$e(wt);{var jt=m=>{},mt=m=>{var I=Ss(),O=a(I);{var st=S=>{var k=is(),Y=a(k),oe=a(Y,!0);t(Y),t(k),d(Ue=>r(oe,Ue),[()=>s()("knowledgeBases.fileUpload.success",{default:"File uploaded and ingestion started successfully!"})]),i(S,k)};f(O,S=>{e(A)&&S(st)})}var Ge=o(O,2);{var Ft=S=>{var k=ns(),Y=a(k),oe=a(Y,!0);t(Y),t(k),d(()=>r(oe,e(x))),i(S,k)};f(Ge,S=>{e(x)&&S(Ft)})}var ht=o(Ge,2);{var Qt=S=>{var k=vs(),Y=a(k),oe=a(Y,!0);t(Y);var Ue=o(Y,2),de=a(Ue);de.__change=[Or,ae,A,x],t(Ue);var ge=o(Ue,2);{var ot=C=>{var j=ds(),$t=a(j);t(j),d(it=>r($t,`${e(ae).name??""} (${it??""})`),[()=>et(e(ae).size)]),i(C,j)};f(ge,C=>{e(ae)&&C(ot)})}t(k),d(C=>r(oe,C),[()=>s()("knowledgeBases.fileUpload.fileLabel",{default:"Select File"})]),i(S,k)};f(ht,S=>{var k;((k=e(y))==null?void 0:k.kind)==="file-ingest"&&S(Qt)})}var Ze=o(ht,2),kt=a(Ze),Jt=a(kt,!0);t(kt);var Bt=o(kt,2),ke=a(Bt);ke.__change=[us,p],Gt(ke,21,()=>e(z),qa,(S,k,Y)=>{var oe=cs(),Ue=a(oe);t(oe),oe.value=oe.__value=Y,d(()=>{La(oe,Y===e(Je)),r(Ue,`${e(k).name??""} - ${e(k).description??""}`)}),i(S,oe)}),t(ke),t(Bt),t(Ze);var Ie=o(Ze,2);{var lt=S=>{var k=qs(),Y=a(k),oe=a(Y,!0);t(Y);var Ue=o(Y,2);Gt(Ue,17,()=>Object.entries(e(y).parameters),([de,ge])=>de,(de,ge)=>{var ot=tr(()=>ar(e(ge),2));let C=()=>e(ot)[0],j=()=>e(ot)[1];var $t=$s(),it=a($t),va=a(it),ua=o(va);{var wa=je=>{var ve=fs(),Vt=a(ve);t(ve),d(()=>r(Vt,`(${j().description??""})`)),i(je,ve)};f(ua,je=>{j().description&&je(wa)})}t(it);var qt=o(it,2),nt=a(qt);{var Xe=je=>{var ve=ps();ve.__change=[gs,F,C],Gt(ve,21,()=>j().enum,qa,(ha,Ht)=>{var Ae=ms(),St=a(Ae,!0);t(Ae);var dt={};d(()=>{La(Ae,e(E)[C()]===e(Ht)),r(St,e(Ht)),dt!==(dt=e(Ht))&&(Ae.value=(Ae.__value=e(Ht))??"")}),i(ha,Ae)}),t(ve);var Vt;mr(ve),d(()=>{ie(ve,"id",`param-${C()}-inline`),Vt!==(Vt=e(E)[C()])&&(ve.value=(ve.__value=e(E)[C()])??"",pr(ve,e(E)[C()]))}),i(je,ve)},la=je=>{var ve=Qe(),Vt=$e(ve);{var ha=Ae=>{var St=bs(),dt=a(St);Xt(dt),dt.__change=[_s,F,C];var oa=o(dt,2),ka=a(oa);t(oa),t(St),d(()=>{ie(dt,"id",`param-${C()}-inline`),sr(dt,e(E)[C()]===!0),ie(oa,"for",`param-${C()}-inline`),r(ka,`${j().default?"Enabled":"Disabled"} by default`)}),i(Ae,St)},Ht=Ae=>{var St=Qe(),dt=$e(St);{var oa=Wt=>{var pt=ys();Xt(pt),pt.__change=[xs,F,C],d(Ba=>{ie(pt,"id",`param-${C()}-inline`),$a(pt,e(E)[C()]),ie(pt,"placeholder",Ba)},[()=>j().default!==void 0&&j().default!==null?j().default.toString():""]),i(Wt,pt)},ka=Wt=>{var pt=Qe(),Ba=$e(pt);{var za=Yt=>{var _t=hs(),Tt=$e(_t);Ca(Tt),Tt.__change=[ws,F,C],rr(2),d(Ma=>{ie(Tt,"id",`param-${C()}-inline`),$a(Tt,Ma),ie(Tt,"placeholder",j().description||"Enter values, one per line")},[()=>Array.isArray(e(E)[C()])?e(E)[C()].join(`
`):e(E)[C()]||""]),i(Yt,_t)},Ra=Yt=>{var _t=Bs();Xt(_t),_t.__change=[ks,F,C],d(Tt=>{ie(_t,"id",`param-${C()}-inline`),$a(_t,e(E)[C()]),ie(_t,"placeholder",Tt)},[()=>j().default!==void 0&&j().default!==null?j().default.toString():""]),i(Yt,_t)};f(Ba,Yt=>{j().type==="array"?Yt(za):Yt(Ra,!1)},!0)}i(Wt,pt)};f(dt,Wt=>{j().type==="integer"||j().type==="number"?Wt(oa):Wt(ka,!1)},!0)}i(Ae,St)};f(Vt,Ae=>{j().type==="boolean"?Ae(ha):Ae(Ht,!1)},!0)}i(je,ve)};f(nt,je=>{j().enum&&Array.isArray(j().enum)?je(Xe):je(la,!1)})}t(qt),t($t),d(()=>{ie(it,"for",`param-${C()}-inline`),r(va,`${C()??""}
                                                        ${j().required?" *":""} `)}),i(de,$t)}),t(k),d(de=>r(oe,de),[()=>s()("knowledgeBases.fileUpload.parametersLabel",{default:"Plugin Parameters"})]),i(S,k)};f(Ie,S=>{e(y)&&e(y).parameters&&Object.keys(e(y).parameters).length>0&&S(lt)})}var fe=o(Ie,2),Pt=a(fe),De=a(Pt);{var Be=S=>{var k=bt();d(Y=>r(k,Y),[()=>s()("knowledgeBases.fileUpload.uploadingButton",{default:"Uploading..."})]),i(S,k)},Lt=S=>{var k=Qe(),Y=$e(k);{var oe=de=>{var ge=bt();d(ot=>r(ge,ot),[()=>s()("knowledgeBases.fileUpload.uploadButton",{default:"Upload File"})]),i(de,ge)},Ue=de=>{var ge=bt();d(ot=>r(ge,ot),[()=>s()("knowledgeBases.fileUpload.runButton",{default:"Run Ingestion"})]),i(de,ge)};f(Y,de=>{var ge;((ge=e(y))==null?void 0:ge.kind)==="file-ingest"?de(oe):de(Ue,!1)},!0)}i(S,k)};f(De,S=>{e(Ne)?S(Be):S(Lt,!1)})}t(Pt),t(fe),t(I),d(S=>{var k;r(Jt,S),Pt.disabled=!e(y)||e(Ne)||((k=e(y))==null?void 0:k.kind)==="file-ingest"&&!e(ae)},[()=>s()("knowledgeBases.fileUpload.pluginLabel",{default:"Ingestion Plugin"})]),Ea("submit",I,S=>{S.preventDefault(),ut()}),i(m,I)};f(sa,m=>{e(z).length===0?m(jt):m(mt,!1)},!0)}i(gt,wt)};f(Kt,gt=>{e(ue)?gt(ra):gt(yt,!1)},!0)}i(ne,Ot)};f(Oe,ne=>{e(xe)?ne(rt):ne(Dt,!1)})}t(ee),d(ne=>r(le,ne),[()=>{var ne;return((ne=e(y))==null?void 0:ne.kind)==="file-ingest"?s()("knowledgeBases.fileUpload.sectionTitle",{default:"Upload and Ingest New File"}):s()("knowledgeBases.fileUpload.sectionTitleBase",{default:"Configure and Run Ingestion"})}]),i(be,ee)}),i(K,L)};f(na,K=>{e(h)==="ingest"&&K(xa)})}var ya=o(na,2);{var da=K=>{var L=Ts(),X=a(L),be=a(X,!0);t(X);var ee=o(X,2),W=a(ee),le=a(W),Oe=a(le,!0);t(le);var rt=o(le,2);Ca(rt),t(W);var Dt=o(W,2),ne=a(Dt),Ot=a(ne);{var Kt=m=>{var I=bt();d(O=>r(I,O),[()=>s()("knowledgeBases.detail.query.loadingButton",{default:"Querying..."})]),i(m,I)},ra=m=>{var I=bt();d(O=>r(I,O),[()=>s()("knowledgeBases.detail.query.submitButton",{default:"Submit Query"})]),i(m,I)};f(Ot,m=>{e(M)?m(Kt):m(ra,!1)})}t(ne),t(Dt),t(ee);var yt=o(ee,2);{var gt=m=>{var I=Es(),O=a(I,!0);t(I),d(st=>r(O,st),[()=>s()("knowledgeBases.detail.query.loadingResults",{default:"Fetching results..."})]),i(m,I)};f(yt,m=>{e(M)&&m(gt)})}var wt=o(yt,2);{var sa=m=>{var I=Is(),O=a(I),st=a(O,!0);t(O);var Ge=o(O,2),Ft=a(Ge,!0);t(Ge),t(I),d(ht=>{r(st,ht),r(Ft,e(U))},[()=>s()("knowledgeBases.detail.query.errorTitle",{default:"Error:"})]),i(m,I)};f(wt,m=>{e(U)&&m(sa)})}var jt=o(wt,2);{var mt=m=>{var I=Ls(),O=a(I),st=a(O,!0);t(O);var Ge=o(O,2);{var Ft=ke=>{var Ie=Fs();Gt(Ie,21,()=>e(re).results,qa,(lt,fe,Pt)=>{var De=Ks(),Be=a(De);{var Lt=qt=>{var nt=Ds(),Xe=a(nt),la=o(a(Xe));t(Xe),t(nt),d(()=>{ie(Xe,"href",e(fe).metadata.file_url),ie(Xe,"title",`Open file: ${e(fe).metadata.filename}`),r(la,` ${e(fe).metadata.filename??""}`)}),i(qt,nt)};f(Be,qt=>{var nt,Xe;(nt=e(fe).metadata)!=null&&nt.file_url&&((Xe=e(fe).metadata)!=null&&Xe.filename)&&qt(Lt)})}var S=o(Be,2),k=a(S),Y=a(k);t(k);var oe=o(k,2),Ue=a(oe);t(oe),t(S);var de=o(S,2),ge=a(de),ot=a(ge,!0);t(ge);var C=o(ge,2),j=a(C,!0);t(C),t(de);var $t=o(de,2),it=a($t),va=a(it,!0);t(it);var ua=o(it,2),wa=a(ua,!0);t(ua),t($t),t(De),d((qt,nt,Xe,la,je,ve)=>{r(Y,`${qt??""} ${Pt+1}`),r(Ue,`${nt??""} ${Xe??""}`),r(ot,la),r(j,e(fe).data),r(va,je),r(wa,ve)},[()=>s()("knowledgeBases.detail.query.resultItemTitle",{default:"Result"}),()=>s()("knowledgeBases.detail.query.similarityLabel",{default:"Similarity:"}),()=>e(fe).similarity.toFixed(4),()=>s()("knowledgeBases.detail.query.contentLabel",{default:"Content:"}),()=>s()("knowledgeBases.detail.query.metadataLabel",{default:"Metadata:"}),()=>JSON.stringify(e(fe).metadata,null,2)]),i(lt,De)}),t(Ie),i(ke,Ie)},ht=ke=>{var Ie=Ps(),lt=a(Ie,!0);t(Ie),d(fe=>r(lt,fe),[()=>s()("knowledgeBases.detail.query.noResults",{default:"No relevant results found for your query."})]),i(ke,Ie)};f(Ge,ke=>{e(re).results&&e(re).results.length>0?ke(Ft):ke(ht,!1)})}var Qt=o(Ge,2),Ze=a(Qt),kt=a(Ze,!0);t(Ze);var Jt=o(Ze,2),Bt=a(Jt,!0);t(Jt),t(Qt),t(I),d((ke,Ie,lt)=>{r(st,ke),r(kt,Ie),r(Bt,lt)},[()=>s()("knowledgeBases.detail.query.resultsTitle",{default:"Query Results:"}),()=>s()("knowledgeBases.detail.query.showRawJson",{default:"Show Raw JSON Response"}),()=>JSON.stringify(e(re),null,2)]),i(m,I)};f(jt,m=>{e(re)&&m(mt)})}t(L),d((m,I,O)=>{r(be,m),r(Oe,I),ne.disabled=O},[()=>s()("knowledgeBases.detail.query.title",{default:"Query Knowledge Base"}),()=>s()("knowledgeBases.detail.query.inputLabel",{default:"Enter your query:"}),()=>e(M)||!e(pe).trim()]),Ea("submit",ee,m=>{m.preventDefault(),ze()}),Ka(rt,()=>e(pe),m=>l(pe,m)),i(K,L)};f(ya,K=>{e(h)==="query"&&K(da)})}t(Mt),t(zt),t(V),d((K,L,X,be,ee)=>{r(Fe,e(g).name),r(Me,K),r(tt,L),r(At,e(g).id),Zt(Ye,1,`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${e(h)==="files"?"border-[#2271b3] text-[#2271b3]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`),Sa(Ye,e(h)==="files"?"border-color: #2271b3; color: #2271b3;":""),ie(Ye,"aria-current",e(h)==="files"?"page":void 0),r(Rt,X),Zt(Ee,1,`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${e(h)==="ingest"?"border-[#2271b3] text-[#2271b3]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`),Sa(Ee,e(h)==="ingest"?"border-color: #2271b3; color: #2271b3;":""),ie(Ee,"aria-current",e(h)==="ingest"?"page":void 0),r(aa,be),Zt(Te,1,`${e(h)==="query"?"border-brand text-brand":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`),Sa(Te,e(h)==="query"?"border-color: #2271b3; color: #2271b3;":""),ie(Te,"aria-current",e(h)==="query"?"page":void 0),r(_a,ee)},[()=>e(g).description||s()("knowledgeBases.detail.noDescription",{default:"No description provided."}),()=>s()("knowledgeBases.detail.idLabel",{default:"ID"}),()=>s()("knowledgeBases.detail.filesTab",{default:"Files"}),()=>s()("knowledgeBases.detail.ingestTab",{default:"Ingest Content"}),()=>s()("knowledgeBases.detail.tabs.query",{default:"Query"})]),i(ce,V)},_e=ce=>{var V=As(),Re=a(V,!0);t(V),d(se=>r(Re,se),[()=>s()("knowledgeBases.detail.noData",{default:"No knowledge base data available."})]),i(ce,V)};f(te,ce=>{e(g)?ce(We):ce(_e,!1)},!0)}i(P,J)};f(_,P=>{e(Q)&&!e(g)?P($):P(N,!1)},!0)}i(n,v)};f(ct,n=>{e(T)?n(He):n(Et,!1)})}t(qe),i(b,qe),ga(),me()}ca(["click","change"]);function Rs(){console.log("Back to list called"),Na(`${Aa}/knowledgebases`,{replaceState:!1,keepFocus:!0})}var Ms=u('<div class="flex items-center"><button type="button" class="mr-3 inline-flex items-center p-1 border border-transparent rounded-full shadow-sm text-white bg-[#2271b3] hover:bg-[#195a91] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#2271b3]" style="background-color: #2271b3;"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg></button> <h1 class="text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate"> </h1></div> <p class="mt-1 text-sm text-gray-500"> </p>',1),Os=u('<h1 class="text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate"> </h1> <p class="mt-1 text-sm text-gray-500"> </p>',1),js=u('<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"><div class="pb-5 border-b border-gray-200"><!></div> <div class="mt-6"><!></div></div>');function vl(b,c){fa(c,!0);const s=()=>ea(yr,"$page",me),w=()=>ea(pa,"$_",me),[me,B]=ma();let g=q("list"),T=q("");Fa(()=>{console.log("KnowledgeBases page mounted"),Q()});function Q(){const x=s().url.searchParams,A=x.get("view"),R=x.get("id");l(g,A==="detail"&&R?"detail":"list",!0),l(T,e(g)==="detail"&&R||"",!0),console.log("State updated from URL - view:",e(g),"kbId:",e(T))}Da(()=>{s().url&&Q()});function H(x){const A=x.detail.id;console.log("View event received for KB:",A),Na(`${Aa}/knowledgebases?view=detail&id=${A}`,{replaceState:!1,keepFocus:!0})}var h=js(),z=a(h),xe=a(z);{var ue=x=>{var A=Ms(),R=$e(A),pe=a(R);pe.__click=[Rs];var re=o(pe,2),M=a(re,!0);t(re),t(R);var U=o(R,2),Ke=a(U,!0);t(U),d((vt,ye,et)=>{ie(pe,"aria-label",vt),r(M,ye),r(Ke,et)},[()=>w()("knowledgeBases.backButton",{default:"Back to knowledge bases list"}),()=>w()("knowledgeBases.detailTitle",{default:"Knowledge Base Details"}),()=>w()("knowledgeBases.detailDescription",{default:"View details and manage files for this knowledge base."})]),i(x,A)},y=x=>{var A=Os(),R=$e(A),pe=a(R,!0);t(R);var re=o(R,2),M=a(re,!0);t(re),d((U,Ke)=>{r(pe,U),r(M,Ke)},[()=>w()("knowledgeBases.pageTitle",{default:"Knowledge Bases"}),()=>w()("knowledgeBases.pageDescription",{default:"Manage your knowledge bases for use with learning assistants."})]),i(x,A)};f(xe,x=>{e(g)==="detail"&&e(T)?x(ue):x(y,!1)})}t(z);var Je=o(z,2),E=a(Je);{var ae=x=>{zs(x,{get kbId(){return e(T)}})},Ne=x=>{Mr(x,{$$events:{view:H}})};f(E,x=>{e(g)==="detail"&&e(T)?x(ae):x(Ne,!1)})}t(Je),t(h),i(b,h),ga(),B()}ca(["click"]);export{vl as component};
